---
title: 在拓扑内的服务器上安装 Skype for Business Server 2015
ms.author: kenwith
author: kenwith
manager: serdars
ms.date: 2/15/2018
ms.audience: ITPro
ms.topic: get-started-article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.custom: Strat_SB_Admin
ms.assetid: defd6b2c-f267-4f8c-bc94-8894e2a429b6
description: '摘要： 了解如何在拓扑结构中每个服务器上安装 Skype 业务服务器 2015年系统组件。 有关从 Microsoft 评估中心的业务服务器 2015年下载免费试用版的 Skype: https://www.microsoft.com/evalcenter/evaluate-skype-for-business-server。'
ms.openlocfilehash: 6d395ff382ae27e47b95d63b01266694108d22cd
ms.sourcegitcommit: 7d819bc9eb63bfd85f5dada09f1b8e5354c56f6b
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/28/2018
---
# <a name="install-skype-for-business-server-2015-on-servers-in-the-topology"></a>在拓扑内的服务器上安装 Skype for Business Server 2015
 
**摘要：**了解如何在拓扑结构中每个服务器上安装 Skype 业务服务器 2015年系统组件。 有关从[Microsoft 评估中心](https://www.microsoft.com/evalcenter/evaluate-skype-for-business-server)业务服务器 2015年下载 Skype 的免费试用版。
  
拓扑结构加载到中央管理存储并 Active Directory 知道哪些服务器将执行哪些角色后，您需要每个拓扑中的服务器上安装的业务服务器系统 Skype。 您可以按照任意顺序完成第 1 步至第 5 步。 但第 6、7、8 步必须在第 1 步至第 5 步之后按照图表所示顺序依次完成。 安装业务服务器系统 Skype 是 8 的第 7 步。
  
![概述图表。](../../media/6855713d-a5b4-4e5b-8f83-fef3d7a5ec5d.png)
  
## <a name="install-skype-for-business-server-system"></a>安装 Skype 业务服务器系统

一旦您已发布的拓扑结构，您可以拓扑结构中每个服务器上安装 Skype 业务服务器组件。 这一节将指导您完成为业务服务器安装 Skype，并设置前端池中的服务器角色和前端服务器与搭配任何服务器角色。 要安装和设置服务器角色，则运行 Skype 业务服务器部署向导的每台计算机安装服务器角色。 使用部署向导完成所有四个部署步骤，包括安装本地配置存储、安装前端服务器、配置证书和启动服务。
  
> [!IMPORTANT]
> 您必须使用拓扑生成器完成并发布拓扑结构，才能安装 Skype 业务服务器的服务器上。 
  
> [!NOTE]
> 必须对拓扑中的所有服务器完成此步骤。 
  
> [!CAUTION]
> 在前端服务器上的业务服务器安装 Skype 之后，首次开始服务，您必须确保 Windows 防火墙服务正在运行的服务器上。 
  
> [!CAUTION]
> 执行这些步骤之前，请确保您正在登录到该服务器具有本地管理员和 RTCUniversalServerAdmins 组成员的域用户帐户。 
  
> [!NOTE]
> 如果在此服务器上没有运行业务服务器安装 Skype，系统将提示您驱动器和安装路径。 如果您的组织要求安装到系统驱动器之外的某个驱动器上或者您考虑空间问题，这将允许您安装到非系统驱动器上。 您可以向一个新的可用驱动器 Skype 业务服务器文件的**安装程序**对话框中更改安装位置路径。 如果您将安装程序文件安装到此路径，包括 OCSCore.msi，Skype 业务服务器文件的其余部分将部署那里也。
  
> [!IMPORTANT]
> 在开始安装之前，请确保 Windows 服务器是通过 Windows 更新保持最新。 
  
![Windows Server 最新版本。](../../media/a8d57a97-a55e-443b-b304-c534ae9a71b2.png)
  
### <a name="install-skype-for-business-server-system"></a>安装 Skype 业务服务器系统

1. 插入 Skype 业务服务器 2015年安装媒体。 如果安装未自动开始，请双击“**安装**”。
    
2. 安装介质需要 Microsoft Visual C++ 才能运行。将有一个对话框弹出，询问您是否要安装。单击“**是**”。
    
3. 仔细阅读许可协议，如果同意条款，请选择“**我接受许可协议中的条款**”，然后单击“**确定**”。 
    
4. 智能安装程序是在其中您可以连接到互联网以检查有更新从 Microsoft 更新 (MU) 在安装过程中，如图中所示的业务服务器 2015年的 Skype 的功能。 这能确保你获得最新产品更新，从而提供更好的体验。 单击“**安装**”开始安装。
    
    > [!NOTE]
    > 很多组织在其企业环境中部署了 Windows Server Update Services (WSUS)。 WSUS 可以让管理员完全管理通过 Microsoft Update 发布到其网络中的计算机的更新分发过程。 累积更新 1 发行版的一部分作为业务服务器的 Skype 引入智能安装程序才能使用 WSUS 的支持。 与第一次业务服务器部署 Skype 或从 Lync Server 2013 环境使用适当升级功能升级的 WSUS 客户可以智能提取 WSUS Skype 的 Windows 更新数据而不获取更新的安装程序从 MU。 想使用智能设置的客户在运行 Setup.exe 之前，需要在所有计算机上运行 SmartSetupWithWSUS.psq。 
  
     ![智能设置屏幕截图。](../../media/d35c6cd9-3b8d-4510-871c-30ad07b1f4f2.png)
  
5. 在部署向导页中，单击**安装或更新 Skype 业务服务器系统**。
    
6. 如果您完成了这些在下面的过程中，执行的步骤，单击**退出**以关闭 [部署向导]。 对池中的每台前端服务器重复此过程。
    
### <a name="step-1-install-local-configuration-store"></a>步骤 1：安装本地配置存储

1. 检查前提条件，单击”**步骤 1：安装本地配置存储**”旁边的“**运行**”。
    
    > [!NOTE]
    > 本地配置存储是中央管理存储的只读副本。在 Standard Edition 部署中，将使用前端服务器上的 SQL Server Express Edition 本地副本创建中央管理存储。在运行“准备第一台 Standard Edition Server”流程时将出现此情况。在 Enterprise Edition 部署中，在您发布包含 Enterprise Edition 前端池的拓扑时，将会创建中央管理存储。 
  
2. 在“**安装本地配置存储**”页面上，确保选择“**直接从中央管理存储中检索**”选项，然后单击“**下一步**”。
    
    SQL Server Express Edition 将安装到本地服务器上。SQL Server Express Edition 是本地配置存储的必要前提。
    
3. 完成本地服务器配置安装后，单击“**完成**”。
    
### <a name="step-2-setup-or-remove-skype-for-business-server-components"></a>步骤 2： 安装或删除 Skype 业务服务器组件

1. 检查系统必备组件，，然后单击**运行**下一步**步骤 2： 安装或删除的 Skype 业务服务器组件的**。
    
2. 在**设置了 Skype 业务服务器组件的**页面上，单击**下一步**中您已发布的拓扑定义设置组件。
    
3. “**正在执行命令**”页将显示安装过程中的命令和安装信息摘要。 完成后，您可以使用列表来选择一个日志以查看，，然后单击**查看日志**。
    
4. 当 Skype 业务服务器组件安装完毕并已审阅日志，根据需要时单击**完成**以完成此步骤安装中。
    
    > [!NOTE]
    > 如果提示重新启动服务器（如果需要安装 Windows 桌面体验则可能会发生这种情况），请执行此操作。 当计算机重新启动并且正在运行，您需要运行此 (步骤 2： 安装或删除业务服务器组件的 Skype) 试程序。 
  
    > [!NOTE]
    > 如果安装程序发现存在任何未满足的先决条件，系统将向您通知一条“不满足先决条件”消息，如图所示。 满足必需的系统必备，然后再开始这 (步骤 2： 安装或删除业务服务器组件的 Skype) 试程序。 
  
     ![需要必备组件。](../../media/21a84dfe-70ff-4f76-bd7e-41032660200a.png)
  
5. 验证前两步已经如期完成。确认显示如图所示的绿色对勾和“**完成**”字样。
    
     ![安装组件时已完成的前两个步骤。](../../media/59851804-d805-4fa8-854b-60c3de2d109f.png)
  
6. 运行**Windows 更新**再次以检查是否有任何更新后的业务服务器组件安装 Skype。
    
### <a name="step-3-request-install-or-assign-certificates"></a>步骤 3：请求、安装或分配证书

1. 检查先决条件，然后单击“**步骤 3：请求、安装或分配证书**”旁边的“**运行**”。
    
    > [!NOTE]
    > Skype 业务服务器支持 sha-2 套件 (SHA 2 使用摘要长度 224、 256、 384 或 512 位) 摘要哈希和签名算法来从运行 Windows 10、 Windows 8，Windows 7、 Windows Server 2012 R2、 Windows 的客户端连接的Server 2012 或 Windows Server 2008 R2 的操作系统。 要支持使用 SHA-2 套件进行外部访问，外部证书必须由公共 CA 颁发，公共 CA 也可颁发具有相同位长度摘要的证书。 
  
    > [!IMPORTANT]
    > 选择哪种哈希摘要和签名算法取决于将使用证书的客户端和服务器，客户端和服务器将与其通信的其他计算机和设备也必须知道如何使用证书中使用的算法。 在哪些摘要长度支持操作系统和一些客户端应用程序中的信息，请参阅[Windows PKI 博客 SHA2 和窗口](https://go.microsoft.com/fwlink/p/?LinkId=287002)。 
  
    每台 Standard Edition 或前端服务器最多需要四个证书：oAuthTokenIssuer 证书、默认证书、Web 内部证书和 Web 外部证书。 但是，也可以请求和分配单个具有相应使用者替代名称条目的默认证书以及 oAuthTokenIssuer 证书。 有关证书要求的详细信息，请参阅[有关业务服务器 2015年的 Skype 的环境要求](../../plan-your-deployment/requirements-for-your-environment/environmental-requirements.md)。
    
    > [!IMPORTANT]
    > 以下过程介绍了如何配置来自基于内部 Active Directory 证书服务的证书颁发机构的证书。 
  
2. 在“**证书向导**”页上，单击“**请求**”。
    
3. 在“**证书请求**”页上，填写相关数据，包括选择 SIP 域在内，然后单击“**下一步**”。
    
4. 在“**延迟的请求或即时请求**”页上，可通过单击“**下一步**”接受默认的“**立即将请求发送给联机证书颁发机构**”选项。如果选择此选项，具有自动联机注册的内部 CA 必须可用。如果选择了延迟请求的选项，系统将提示您输入用于保存证书请求文件的名称和位置。证书请求必须由组织内部的 CA 或公共 CA 提出和处理。然后您需要导入证书响应并将其分配给适当的证书角色。
    
5. 在**选择一个证书颁发机构 (CA)**页上，选择**选择从列表在您的环境中检测到 CA**选项，，然后选择 （通过在 Active Directory 域服务中注册） 已知 CA 列表中的。 或者，选择“**指定其他证书颁发机构**”选项，在框中输入其他 CA 的名称，然后单击“**下一步**”。
    
6. 在“**证书颁发机构帐户**”页上，将提示您提供凭据，以在 CA 中请求证书和处理证书请求。您应该已经确定提前请求证书是否需要用户名和密码。CA 管理员将拥有所需的信息，并且可能需要协助您完成此步骤。如果需要提供备用凭据，请选中相应的复选框，在文本框中输入用户名和密码，然后单击“**下一步**”。
    
7. 在“**指定替代证书模板**”页上，要使用默认的 Web 服务器模板，请单击“**下一步**”。
    
    > [!NOTE]
    > 如果组织已经创建了模板，以用作默认 Web 服务器 CA 模板的备用模板，请选中相应的复选框，然后输入备用模板的名称。您将需要 CA 管理员定义的模板名称。 
  
8. 在“**名称和安全设置**”页上，指定一个“**友好名称**”。 通过使用友好名称，您可以快速标识证书和目的。 如果将此处留空，则系统会自动生成一个名称。 设置密钥的“**位长度**”，或接受默认值 2048 位。 如果您确定，证书和私钥需要移动或复制到其他系统，则选择**标记为可导出的证书的专用密钥**，然后单击**下一步**。
    
    > [!NOTE]
    > Skype 业务服务器有可导出私钥的最低要求。 其中一个可导出的位置是池中的边缘服务器，在这里媒体中继身份验证服务使用证书副本，而不是对池中的每个实例都分别使用单个证书。 
  
9. 在“**组织信息**”页上，可选择提供组织信息，然后单击“**下一步**”。
    
10. 在“**地理信息**”页上，可选择提供地理信息，然后单击“**下一步**”。
    
11. 在“**使用者名称/使用者替代名称**”页上，检查将添加的使用者替代名称，然后单击“**下一步**”。
    
12. 在“**SIP 域设置**”页上，选择“**SIP 域**”，然后单击“**下一步**”。
    
13. 在“**配置其他使用者替代名称**”页上，添加其他任何需要的使用者替代名称，包括将来其他 SIP 域可能需要的使用者替代名称，然后单击“**下一步**”。
    
14. 在“**证书请求摘要**”页上，检查摘要中的信息。如果信息正确，请单击“**下一步**”。如果需要更正或修改设置，请单击“**上一步**”返回相应的页面进行更正或修改。
    
15. 在“**正在执行命令**”页上，单击“**下一步**”。
    
16. 在“**联机证书请求状态**”页上，检查返回的信息。 请注意，证书已发布并安装到本地证书存储中。 如果它报告为已经发出和安装，但它是无效，请确保已安装了 CA 根证书服务器的受信任根 CA 存储中。 有关如何检索受信任根 CA 证书的信息，请参阅 CA 文档。 如果需要查看检索的证书，请单击“**查看证书详细信息**”。 默认情况下，为**业务服务器证书用途的 Skype 向其分配证书**复选框被选中。 如果要手动分配证书，请清除此复选框，然后单击“**完成**”。
    
17. 如果您在上一页上**业务服务器证书用途的 Skype 向其分配证书**的清除了复选框，您将看到**证书分配**页。 单击“**下一步**”。
    
18. 在“**证书存储**”页上，选择已请求的证书。如果要查看证书，请单击“**查看证书详细信息**”，然后单击“**下一步**”继续。
    
    > [!NOTE]
    > 如果“**联机证书请求状态**”页报告证书存在问题（例如证书无效），查看实际证书可协助解决问题。可能导致证书无效的两个具体问题为：先前提到的受信任根 CA 证书缺失，与证书相关联的私钥缺失。有关如何解决这两个问题的信息，请参阅 CA 文档。
  
19. 在“**证书分配摘要**”页上，检查显示的信息以确保此证书是应分配的证书，然后单击“**下一步**”。
    
20. 在“**正在执行命令**”页上，检查命令的输出。如果要检查分配过程或查看是否出现错误或警告，请单击“**查看日志**”。检查完成后，单击“**完成**”。
    
21. 在“**证书向导**”页上，确认所有服务均显示绿色对勾，指示均已分配证书，包括图中所示的 OAuthTokenIssuer 在内，然后单击“**关闭**”。
    
     ![已正确安装和分配的证书。](../../media/d8e1911c-d096-4f88-97a9-d2a704defa17.png)
  
    > [!TIP]
    > 如果您在实验室环境中进行安装，并且使用 Active Directory 证书服务设置了证书颁发机构，您需要重新启动运行证书服务的服务器和前端服务器，然后才能成功颁发证书。 
  
    > [!TIP]
    >  有关在 Active Directory 证书服务的证书的详细信息，请参阅[Active Directory 证书服务](https://technet.microsoft.com/en-us/windowsserver/dd448615.aspx)。 
  
### <a name="step-4-start-services"></a>步骤 4：启动服务

1. 检查“**步骤 4：启动服务**”的先决条件。
    
2. 如果是具有至少三台服务器的 Enterprise Edition 前端池，将使用 Windows Fabric，同时您必须使用 **Start-CsPool** cmdlet。 如果一台服务器使用，则始终是与标准版的这种情况，您必须使用**开始 CsWindowsService** cmdlet。 在此示例中我们有三个前端服务器的池中使用企业版， **Skype 的业务服务器管理外壳程序**打开并运行**开始 CsPool** cmdlet，如图中所示。 对于其他所有角色（包括 Standard Edition 服务器），您必须使用 **Start-CsWindowsService**。 要部署前端角色之外的角色，请参见这些特定角色的说明文档。
    
     ![启动 Skype for Business 服务。](../../media/f52ec719-9476-419f-9a78-df08368395f7.png)
  
3. 在“**正在执行命令**”页上，成功启动所有服务后，单击“**完成**”。
    
    > [!IMPORTANT]
    > 用于启动服务器上的服务的命令是报告实际上已启动服务的最佳方法。 该命令可能无法反映服务的实际状态。 建议使用步骤“**服务状态（可选）**”来打开 Microsoft 管理控制台 (MMC) 并确认服务已成功启动，如图所示。 如果任何 Skype 业务服务器服务未启动，可以用鼠标右键单击在 MMC 中，该服务，然后单击**启动**。 
  
     ![验证服务是否已启动。](../../media/47906fb7-9d37-4d55-8d8d-e5a4a2366510.png)
  

