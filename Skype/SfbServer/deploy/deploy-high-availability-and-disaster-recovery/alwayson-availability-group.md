---
title: 在 Skype for Business 服务器的后端服务器上部署 Alwayson 可用性组
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
audience: ITPro
ms.topic: quickstart
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: c93c01e6-626c-40ad-92dd-373b0fe9189f
description: 在 Skype for Business Server 部署中部署（安装） Alwayson 可用性组。
ms.openlocfilehash: d69e370716af2b23c57ad463ea7f4651ea0ea89a
ms.sourcegitcommit: b1229ed5dc25a04e56aa02aab8ad3d4209559d8f
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/06/2020
ms.locfileid: "41798269"
---
# <a name="deploy-an-always-on-availability-group-on-a-back-end-server-in-skype-for-business-server"></a>在 Skype for Business 服务器的后端服务器上部署 Alwayson 可用性组
 
在 Skype for Business Server 部署中部署（安装） Alwayson 可用性组（AG）。
  
部署 AG 的方式取决于你是在新池中部署它、使用镜像的现有池还是当前对于后端数据库没有高可用性的现有池。
  
> [!NOTE]
> 不支持将 AG 与持久聊天服务器角色配合使用。 
  
- [在新的前端池上部署 Alwayson 可用性组](alwayson-availability-group.md#BKMK_NewPool_CreateAlwaysOnGroup)
    
- [在使用数据库镜像的现有池上部署 Alwayson 可用性组](alwayson-availability-group.md#BKMK_MirroredPool_CreateAlwaysOnGroup)
    
- [在不使用数据库镜像的现有池上部署 Alwayson 可用性组](alwayson-availability-group.md#BKMK_NoHAPool_CreateAlwaysOnGroup)
    
## <a name="deploy-an-always-on-availability-group-on-a-new-front-end-pool"></a>在新的前端池上部署 Alwayson 可用性组
<a name="BKMK_NewPool_CreateAlwaysOnGroup"> </a>

1. 在将成为 AG 的一部分的所有数据库服务器上启用故障转移群集功能。 在每台服务器上，执行以下操作
    
   - 打开“服务器管理器”，然后单击“**添加角色和功能**”。
    
   - 单击“**下一步**”，直至达到“**选择功能**”框。在这里选中“**故障转移群集**”复选框。
    
   - 在“**添加故障转移群集所需的功能？**”框中，单击“**添加功能**”。
    
   - 单击“**安装**”。
    
2. 验证群集配置。
    
   - 在“服务器管理器”中，单击“**工具**”菜单，然后单击“**故障转移群集管理器**”。
    
   - 在屏幕右侧的“**操作**”中，单击“**验证配置**”。
    
   - 在“**在你开始前**”页上，单击“**下一步**”。
    
   - 选择要添加到群集的服务器，然后单击“**运行所有测试**”。
    
   - 在“**摘要**”框中，检查向导报告的任何错误。然后单击“**完成**”完成验证。
    
     向导可能报告多个警告，尤其是在你未使用共享存储的情况下。你不是必须要使用共享存储。但是，如果看到任何**错误**消息，则必须修正这些问题后才能继续。
    
3. 创建 Windows Server 故障转移群集（WSFC）。
    
   - 在“**故障转移群集管理**”向导中，右键单击“**故障转移群集管理**”，然后单击“**创建群集**”。
    
   - 在“**在你开始前**”页上，单击“**下一步**”。
    
   - 添加群集名称和 IP 地址。验证设置后，单击“**下一步**”。
    
   - 在“确认”页上，单击“**下一步**”。
    
   - 创建群集后，单击“**完成**”。
    
4. 我们建议配置群集仲裁设置来使用文件共享见证。为此，请使用以下步骤：
    
   - 右键单击群集名称，单击“**更多操作**”，然后单击“**配置群集仲裁设置**”。
    
   - 在“**选择仲裁配置选项**”页上，单击“**选择仲裁见证**”。
    
   - 在“**选择仲裁见证**”页中，单击“**配置文件共享见证**”。
    
   - 在“**配置文件共享见证**”页中，键入要使用的文件共享的路径，然后单击“**下一步**”。
    
   - 在“**确认**”页上，单击“**下一步**”。
    
5. 在群集中的每台服务器上，在 SQL Server 配置管理器中启用 AG 功能。
    
   - 打开 SQL Server 配置管理器。在屏幕左侧的树中，单击“**SQL Server 服务**”，然后双击“SQL Server 服务”。 
    
   - 在“**属性**”框中，选择“**AlwaysOn 高可用性**”选项卡。选中“**启用 AlwaysOn 可用性组**”复选框。出现提示时，重新启动 SQL Server 服务。
   
6. 使用拓扑生成器创建前端池，如在[Skype For Business 服务器中创建和发布新拓扑中](../../deploy/install/create-and-publish-new-topology.md)所述。 执行此操作时，请将 AG 指定为池的 SQL 应用商店。
    
7. 创建可用性组。
    
   - 打开 SQL Server Management Studio，然后连接到 SQL Server 实例。
    
   - 在对象资源管理器中，展开 "**始终在高可用性"** 文件夹。 右键单击“**可用性组**”文件夹，然后单击“**新建可用性组向导**”。
    
   - 如果出现“**简介**”页，单击“**下一步**”。
    
   - 在“**指定可用性组名称**”页中，输入可用性组的名称，然后单击“**下一步**”。
    
   - 在 "选择数据库" 页中，选择要包含在 "AlwaysOn 可用性" 组中的数据库。 然后单击" **下一步**"。
    
     不要在 "AlwaysOn 可用性" 组中包含**ReportServer**、 **ReportServerTempDB**或持久聊天数据库，因为这种情况下不支持这些数据库。 可以在 "AlwaysOn 可用性" 组中包括所有其他 Skype for business 服务器数据库。
    
   - 在“**指定副本**”页上，单击“**副本**”选项卡。然后单击“**添加副本**”按钮，并连接到你作为 Windows Server 故障转移群集的节点加入的其他 SQL 实例。
    
   - 对于每个实例，选择“**自动故障转移**”和“**同步提交**”选项。不要选择“**可读辅助副本**”选项。
    
   - 单击“**端点**”选项卡，并验证“**端口号**”设为 5022。
    
   - 单击“**侦听器**”选项卡，选择“**创建可用性组侦听器**”选项。在该选项下面，键入侦听器的名称，然后将“**端口**”设置为 1433（对于此选项，不支持其他端口）。
    
   - 单击“**添加**”，然后在“**IPv4 地址**”框中，提供你的首选虚拟 IP 地址，然后单击“**确定**”。
    
   - 在“**选择初始数据同步**”页上，选择“完全”，然后指定副本可访问，并且两个副本所使用的 SQL Server 服务帐户有写入权限的文件夹。然后单击“**下一步**”。
    
     初始化数据库时，会临时使用此文件共享。如果在处理大数据库，我们建议手动初始化数据库，以防网络带宽容不下数据库备份的大小。
    
   - 在“验证”页上，确认所有验证检查都已成功，然后单击“**下一步**”。
    
   - 在“**摘要**”页上，验证所有设置，然后单击“完成”。
      
8. 部署池和 AG 后，执行一些最终步骤以确保 SQL 登录位于 AlwaysOn 可用性组中的每个副本上。 
    
   - 打开拓扑生成器，**从现有部署**中选择 "下载拓扑"，然后单击 **"确定"**。
    
   - 依次展开 Skype for Business Server、你的拓扑，以及“**SQL Server 存储**”。 右键单击新的 "AlwaysOn 可用性" 组的 SQL 应用商店，然后单击 "**编辑属性**"。
    
     - 在页面底部的 " **SQL SERVER FQDN** " 框中，将值更改为 AG 的侦听器的 FQDN。
    
   - 发布拓扑。从“**操作**”菜单中，单击“**拓扑**”，然后单击“**发布**”。在确认页上，单击“**下一步**”。然后等待几分钟，让新拓扑进行复制。
    
   - 打开 SQL Server Management Studio，然后导航到 AG。 将其故障转移到辅助副本。
    
   - 打开 Skype for Business Server 命令行管理程序，键入以下 cmdlet 以在此复制副本上创建 SQL 登录：
    
   ```powershell
   Install-CsDatabase -Update
   ```

   - 对组中的每个副本重复前两个步骤（将组故障转移`Install-CsDatabase -Update`到辅助副本，然后再使用）。
    
## <a name="deploy-an-always-on-availability-group-on-an-existing-pool-that-uses-database-mirroring"></a>在使用数据库镜像的现有池上部署 Alwayson 可用性组
<a name="BKMK_MirroredPool_CreateAlwaysOnGroup"> </a>

> [!NOTE]
> 如果你要升级到 AG 的池托管你的组织的中央管理存储，则必须先将 CMS 移动到另一个池，然后再升级此池。 可使用 Move-CsManagementServer cmdlet 来移动池。 如果你的组织中没有其他池，则可以临时部署标准版服务器，并将 CMS 迁移到此服务器，然后再将你的池升级到 AG。 
  
1. 通过打开 Skype for Business Server 命令行管理程序并键入以下 cmdlet，将所有数据从镜像故障转移到主体节点。
    
   ```powershell
   Invoke-CsDatabaseFailover -PoolFqdn <Pool FQDN> -DatabaseType <DatabaseType> -NewPrincipal "Primary"
   ```

    对池中的每种数据库类型重复此 cmdlet。可以使用下面的 cmdlet 查找存储在此池中的所有数据库类型。
     
   ```powershell
   Get-CsPool -Identity <Pool FQDN>
   ```

2. 使用拓扑生成器从池中删除数据库镜像。
    
   - 打开拓扑生成器。 在拓扑中，展开“**Enterprise Edition 前端池**”，右键单击池的名称，然后单击“**编辑属性**”。
    
   - 对于池中的每种 SQL 存储类型，不要选中“**启用 SQL 存储镜像**”复选框。
    
3. 发布更改后的拓扑。从“**操作**”菜单中，单击“**拓扑**”，然后单击“**发布**”。然后在确认页中，单击“**下一步**”
    
4. 使用 SQL Server Management Studio 打破镜像。
    
   - 打开 SQL Server Management Studio，转到数据库，右键单击“**任务**”，再单击“**镜像**”。然后单击“**取消镜像**”，再单击“**确定**”。
    
   - 对将转换为 AG 的池中的所有数据库重复此操作。
    
5. 在将成为 AG 的一部分的所有数据库服务器上设置故障转移群集功能。 在每台服务器上，执行以下操作
    
   - 打开“服务器管理器”，然后单击“**添加角色和功能**”。
    
   - 单击“**下一步**”，直至达到“**选择功能**”框。在这里选中“**故障转移群集**”复选框。
    
   - 在“**添加故障转移群集所需的功能？**”框中，单击“**添加功能**”。
    
   - 单击“**安装**”。
    
6. 验证群集配置。
    
   - 在“服务器管理器”中，单击“**工具**”菜单，然后单击“**故障转移群集管理器**”。
    
   - 在屏幕右侧的“**操作**”中，单击“**验证配置**”。
    
   - 在“**在你开始前**”页上，单击“**下一步**”。
    
   - 选择要添加到群集的服务器，然后单击“**运行所有测试**”。
    
   - 在“**摘要**”框中，检查向导报告的任何错误。然后单击“**完成**”完成验证。
    
     向导可能报告多个警告，尤其是在你未使用共享存储的情况下。你不是必须要使用共享存储。但是，如果看到任何**错误**消息，则必须修正这些问题后才能继续。
    
7. 创建 Windows Server 故障转移群集。
    
   - 在“**故障转移群集管理**”向导中，右键单击“**故障转移群集管理**”，然后单击“**创建群集**”。
    
   - 在“**在你开始前**”页上，单击“**下一步**”。
    
   - 添加群集名称和 IP 地址。验证设置后，单击“**下一步**”。
    
   - 在“确认”页上，单击“**下一步**”。
    
   - 创建群集后，单击“**完成**”。
    
8. 我们建议配置群集仲裁设置来使用文件共享见证。为此，请使用以下步骤：
    
   - 右键单击群集名称，单击“**更多操作**”，然后单击“**配置群集仲裁设置**”。
    
   - 在“**选择仲裁配置选项**”页上，单击“**选择仲裁见证**”。
    
   - 在“**选择仲裁见证**”页中，单击“**配置文件共享见证**”。
    
   - 在“**配置文件共享见证**”页中，键入要使用的文件共享的路径，然后单击“**下一步**”。
    
   - 在“**确认**”页上，单击“**下一步**”。
    
9. 在群集中的每台服务器上，在 SQL Server 配置管理器中启用 AG 功能。
    
   - 打开 SQL Server 配置管理器。在屏幕左侧的树中，单击“**SQL Server 服务**”，然后双击“SQL Server 服务”。 
    
   - 在“**属性**”框中，选择“**AlwaysOn 高可用性**”选项卡。选中“**启用 AlwaysOn 可用性组**”复选框。出现提示时，重新启动 SQL Server 服务。
    
10. 创建可用性组。
    
    - 打开 SQL Server Management Studio，然后连接到 SQL Server 实例。
    
    - 在对象资源管理器中，展开 "**始终在高可用性"** 文件夹。 右键单击“**可用性组**”文件夹，然后单击“**新建可用性组向导**”。
    
    - 如果出现“**简介**”页，单击“**下一步**”。
    
    - 在“**指定可用性组名称**”页中，输入可用性组的名称，然后单击“**下一步**”。
    
    - 在 "选择数据库" 页中，选择要包含在 "AlwaysOn 可用性" 组中的数据库。 然后单击" **下一步**"。
    
    不要在 "AlwaysOn 可用性" 组中包含**ReportServer**、 **ReportServerTempDB**或持久聊天数据库，因为这种情况下不支持这些数据库。 可以在 "AlwaysOn 可用性" 组中包括所有其他 Skype for business 服务器数据库。
    
    - 在“**指定副本**”页上，单击“**副本**”选项卡。然后单击“**添加副本**”按钮，并连接到你作为 Windows Server 故障转移群集的节点加入的其他 SQL 实例。
    
    - 对于每个实例，选择“**自动故障转移**”和“**同步提交**”选项。不要选择“**可读辅助副本**”选项。
    
    - 单击“**端点**”选项卡，并验证“**端口号**”设为 5022。
    
      - 单击“**侦听器**”选项卡，选择“**创建可用性组侦听器**”选项。在该选项下面，键入侦听器的名称，然后将“**端口**”设置为 1433（对于此选项，不支持其他端口）。
    
    - 单击“**添加**”，然后在“**IPv4 地址**”框中，提供你的首选虚拟 IP 地址，然后单击“**确定**”。
    
    - 在“**选择初始数据同步**”页上，选择“完全”，然后指定副本可访问，并且两个副本所使用的 SQL Server 服务帐户有写入权限的文件夹。然后单击“**下一步**”。
    
    初始化数据库时，会临时使用此文件共享。如果在处理大数据库，我们建议手动初始化数据库，以防网络带宽容不下数据库备份的大小。
    
    - 在“验证”页上，确认所有验证检查都已成功，然后单击“**下一步**”。
    
    - 在“**摘要**”页上，验证所有设置，然后单击“完成”。
    
11. 创建新的应用商店，指定 AG 侦听器，并将旧镜像的主体指定为 AG 的主节点。
    
    - 打开拓扑生成器。 在拓扑中，展开“**共享组件**”，右键单击“**SQL Server 存储**”，然后单击“**新建 SQL Server 存储**”。
    
    - 在“**定义新的 SQL 存储**”页上，先选中“**高可用性设置**”复选框，然后确保 SQL AlwaysOn 可用性组出现在下拉框中。
    
    - 在“**SQL Server 可用性侦听器 FQDN**”框中，键入在创建可用性组时创建的侦听器 FQDN。
    
    - 在 " **SQL SERVER FQDN** " 框中，键入 AG 的主节点的 FQDN，然后单击 **"确定"**。 这应该是此存储的旧镜像的主节点。
    
12. 将新的 AG 与前端池关联。
    
    - 在拓扑生成器中，右键单击要与 AG 关联的池，然后单击 "**编辑属性**"。
    
    - 在 "**关联**" 下的 " **SQL Server 存储**" 框中，选择 AG。 选择池中要移到 AG 的任何其他数据库的相同组。
    
    - 当您确定所需的所有数据库均设置为 AG 时，单击 **"确定"**。
    
13. 发布拓扑。 从“**操作**”菜单中，单击“**拓扑**”，然后单击“**发布**”。 在确认页上，单击“**下一步**”。
    
14. 执行一些最终步骤以确保 SQL 登录位于 AlwaysOn 可用性组中的每个副本上。
    
    - 打开拓扑生成器，**从现有部署**中选择 "下载拓扑"，然后单击 **"确定"**。
    
    - 依次展开 Skype for Business Server、你的拓扑，以及“**SQL Server 存储**”。 右键单击新 AG 的 SQL 应用商店，然后单击 "**编辑属性**"。
    
    - 在页面底部的 " **SQL SERVER FQDN** " 框中，将值更改为 AG 的侦听器的 FQDN。
    
    - 发布拓扑。从“**操作**”菜单中，单击“**拓扑**”，然后单击“**发布**”。在确认页上，单击“**下一步**”。然后等待几分钟，让新拓扑进行复制。
    
    - 打开 SQL Server Management Studio，然后导航到 AG。 将其故障转移到辅助副本。
    
    - 打开 Skype for Business Server 命令行管理程序，键入以下 cmdlet 以在此复制副本上创建 SQL 登录：
    
    ```powershell
    Install-CsDatabase -Update
    ```

    - 对组中的每个副本重复前两个步骤（将组故障转移`Install-CsDatabase -Update`到辅助副本，然后再使用）。
    
## <a name="deploy-an-always-on-availability-group-on-an-existing-pool-that-does-not-use-database-mirroring"></a>在不使用数据库镜像的现有池上部署 Alwayson 可用性组
<a name="BKMK_NoHAPool_CreateAlwaysOnGroup"> </a>

> [!NOTE]
> 如果你要升级到 AG 的池托管你的组织的中央管理存储，则必须先将 CMS 移动到另一个池，然后再升级此池。 可使用 Move-CsManagementServer cmdlet 来移动池。 如果你的组织中没有其他池，则可以临时部署标准版服务器，并将 CMS 迁移到此服务器，然后再将你的池升级到 AG。 
  
1. 在将成为 AG 的一部分的所有数据库服务器上设置故障转移群集功能。 在每台服务器上，执行以下操作
    
   - 打开“服务器管理器”，然后单击“**添加角色和功能**”。
    
   - 单击“**下一步**”，直至达到“**选择功能**”框。在这里选中“**故障转移群集**”复选框。
    
   - 在“**添加故障转移群集所需的功能？**”框中，单击“**添加功能**”。
    
   - 单击“**安装**”。
    
2. 验证群集配置。
    
   - 在“服务器管理器”中，单击“**工具**”菜单，然后单击“**故障转移群集管理器**”。
    
   - 在屏幕右侧的“**操作**”中，单击“**验证配置**”。
    
   - 在“**在你开始前**”页上，单击“**下一步**”。
    
   - 选择要添加到群集的服务器，然后单击“**运行所有测试**”。
    
   - 在“**摘要**”框中，检查向导报告的任何错误。然后单击“**完成**”完成验证。
    
     向导可能报告多个警告，尤其是在你未使用共享存储的情况下。你不是必须要使用共享存储。但是，如果看到任何**错误**消息，则必须修正这些问题后才能继续。
    
3. 创建 Windows Server 故障转移群集（WSFC）。
    
   - 在“**故障转移群集管理**”向导中，右键单击“**故障转移群集管理**”，然后单击“**创建群集**”。
    
   - 在“**在你开始前**”页上，单击“**下一步**”。
    
   - 添加群集名称和 IP 地址。验证设置后，单击“**下一步**”。
    
   - 在“确认”页上，单击“**下一步**”。
    
   - 创建群集后，单击“**完成**”。
    
4. 我们建议配置群集仲裁设置来使用文件共享见证。为此，请使用以下步骤：
    
   - 右键单击群集名称，单击“**更多操作**”，然后单击“**配置群集仲裁设置**”。
    
   - 在“**选择仲裁配置选项**”页上，单击“**选择仲裁见证**”。
    
   - 在“**选择仲裁见证**”页中，单击“**配置文件共享见证**”。
    
   - 在“**配置文件共享见证**”页中，键入要使用的文件共享的路径，然后单击“**下一步**”。
    
   - 在“**确认**”页上，单击“**下一步**”。
    
5. 在群集中的每台服务器上，在 SQL Server 配置管理器中启用 AG。
    
   - 打开 SQL Server 配置管理器。在屏幕左侧的树中，单击“**SQL Server 服务**”，然后双击“SQL Server 服务”。 
    
   - 在“**属性**”框中，选择“**AlwaysOn 高可用性**”选项卡。选中“**启用 AlwaysOn 可用性组**”复选框。出现提示时，重新启动 SQL Server 服务。
    
6. 创建可用性组。
    
   - 打开 SQL Server Management Studio，然后连接到 SQL Server 实例。
    
   - 在对象资源管理器中，展开 "**始终在高可用性"** 文件夹。 右键单击“**可用性组**”文件夹，然后单击“**新建可用性组向导**”。
    
   - 如果出现“**简介**”页，单击“**下一步**”。
    
   - 在“**指定可用性组名称**”页中，输入可用性组的名称，然后单击“**下一步**”。
    
   - 在 "选择数据库" 页中，选择要包含在 AG 中的数据库。 然后单击" **下一步**"。
    
     不要在 AG 中包括**ReportServer**、 **ReportServerTempDB**或持久聊天数据库，因为这种情况下不支持这些数据库。 您可以在 AG 中包括所有其他 Skype for business 服务器数据库。
    
   - 在 "**指定副本**" 页面上，单击 "**副本**" 选项卡。然后单击 "**添加副本**" 按钮，并连接到作为 WSFC 的节点加入的其他 SQL 实例。
    
   - 对于每个实例，选择“**自动故障转移**”和“**同步提交**”选项。不要选择“**可读辅助副本**”选项。
    
   - 单击“**端点**”选项卡，并验证“**端口号**”设为 5022。
    
   - 单击“**侦听器**”选项卡，选择“**创建可用性组侦听器**”选项。在该选项下面，键入侦听器的名称，然后将“**端口**”设置为 1433（对于此选项，不支持其他端口）。
    
   - 单击“**添加**”，然后在“**IPv4 地址**”框中，提供你的首选虚拟 IP 地址，然后单击“**确定**”。
    
   - 在“**选择初始数据同步**”页上，选择“完全”，然后指定副本可访问，并且两个副本所使用的 SQL Server 服务帐户有写入权限的文件夹。然后单击“**下一步**”。
    
     初始化数据库时，会临时使用此文件共享。如果在处理大数据库，我们建议手动初始化数据库，以防网络带宽容不下数据库备份的大小。
    
     - 在“验证”页上，确认所有验证检查都已成功，然后单击“**下一步**”。
    
   - 在“**摘要**”页上，验证所有设置，然后单击“完成”。
    
7. 创建新的应用商店，指定 AG 侦听器。
    
   - 打开拓扑生成器。 在拓扑中，展开“**共享组件**”，右键单击“**SQL Server 存储**”，然后单击“**新建 SQL Server 存储**”。
    
   - 在“**定义新的 SQL 存储**”页上，先选中“**高可用性设置**”复选框，然后确保 SQL AlwaysOn 可用性组出现在下拉框中。
    
   - 在“**SQL Server 可用性侦听器 FQDN**”框中，键入在创建可用性组时创建的侦听器 FQDN。
    
   - 在 " **SQL SERVER FQDN** " 框中，键入 AG 的主节点的 FQDN，然后单击 **"确定"**。
    
8. 将新的 "始终打开" 可用性组与前端池相关联。
    
   - 在拓扑生成器中，右键单击要与 AG 关联的池，然后单击 "**编辑属性**"。
    
   - 在 "**关联**" 下的 " **SQL Server 存储**" 框中，选择 AG。 选择池中要移到 AG 的任何其他数据库的相同组。
    
   - 当您确定所需的所有数据库均设置为 AG 时，单击 **"确定"**。
    
9. 发布拓扑。 从“**操作**”菜单中，单击“**拓扑**”，然后单击“**发布**”。 在确认页上，单击“**下一步**”。
    
10. 执行一些最终步骤以确保在 AG 中的每个副本上都有 SQL 登录。
    
    - 打开拓扑生成器，**从现有部署**中选择 "下载拓扑"，然后单击 **"确定"**。
    
    - 依次展开 Skype for Business Server、你的拓扑，以及“**SQL Server 存储**”。 右键单击新 AG 的 SQL 应用商店，然后单击 "**编辑属性**"。
    
    - 在页面底部的 " **SQL SERVER FQDN** " 框中，将值更改为 AG 的侦听器的 FQDN。
    
    - 发布拓扑。从“**操作**”菜单中，单击“**拓扑**”，然后单击“**发布**”。在确认页上，单击“**下一步**”。然后等待几分钟，让新拓扑进行复制。
    
    - 打开 SQL Server Management Studio，然后导航到 AG。 将其故障转移到辅助副本。
    
    - 打开 Skype for Business Server 命令行管理程序，键入以下 cmdlet 以在此复制副本上创建 SQL 登录：
    
      ```powershell
      Install-CsDatabase -Update
      ```

      - 对组中的每个副本重复前两个步骤（将组故障转移`Install-CsDatabase -Update`到辅助副本，然后再使用）。
