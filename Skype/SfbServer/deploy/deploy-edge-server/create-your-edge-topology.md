---
title: 为 Skype for Business Server 创建边缘拓扑
ms.reviewer: ''
ms.author: v-cichur
author: cichur
manager: serdars
audience: ITPro
ms.topic: quickstart
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection:
- Strat_SB_Hybrid
ms.custom: ''
ms.assetid: 5ea18841-afdc-4ccb-8d86-30584c1f5aca
description: 摘要：了解如何在 Skype for Business Server 中生成、发布和导出边缘服务器拓扑。
ms.openlocfilehash: 8dff318b5d198eb1e8d59ef465bf648125f31327
ms.sourcegitcommit: c528fad9db719f3fa96dc3fa99332a349cd9d317
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/12/2021
ms.locfileid: "49804392"
---
# <a name="create-your-edge-topology-for-skype-for-business-server"></a>为 Skype for Business Server 创建边缘拓扑
 
**摘要：** 了解如何在 Skype for Business Server 中生成、发布和导出边缘服务器拓扑。
  
拓扑生成器是生成边缘服务器拓扑所需的工具，就像它用于 Skype for Business Server 的任何拓扑组件一样。 在按照以下步骤操作之前，至少需要设置一个前端池或 Standard Edition Server。
  
我们将在本文中介绍以下主题：
  
- 构建边缘服务器拓扑
    
- 发布边缘服务器拓扑
    
- 导出边缘服务器拓扑
    
  > [!NOTE]
  > 若要按照以下步骤操作，你需要以以下域组的成员用户登录下面提到的域服务器： 
  
- RTCUniversalServerAdmins
    
- Domain Admins
    
## <a name="build-your-edge-server-topology"></a>构建边缘服务器拓扑

第一个部署步骤是构建 Skype for Business Server 边缘服务器拓扑，其中包括以下三个选项之一：
  
- 单个边缘服务器
    
- DNS 负载平衡边缘池 (一台或多台服务器) 
    
- 硬件负载平衡边缘池 (一台或多台服务器) 
    
如果您不确定所需的内容，那么在开始执行这些步骤之前，应该先了解一下规划文档。 否则，让我们开始吧。
  
### <a name="defining-the-topology-for-a-single-edge-server"></a>定义单个边缘服务器的拓扑

1. 登录到 Skype for Business Server Standard Edition Server 或 Skype for Business Server 前端池。
    
2. 一旦存在，打开 **Skype for Business Server 拓扑生成器**。
    
3. 在控制台树中，展开要部署边缘服务器的站点。
    
4. 右键单击 **边缘池**，然后单击 **"新建边缘池"。**
    
5. 你将 **在"定义** 新边缘池 **"屏幕上单击"下一步** "。
    
6. 在"定义边缘池 **FQDN"** 屏幕上，键入边缘服务器将使用的内部完全限定域名 (FQDN) ，然后选择"单计算机池"，完成后单击"下一步"。 
    
7. 在 **"选择功能** "屏幕上，可以选择：
    
   - 你可能打算对 SIP 访问服务、Skype for Business Server Web 会议服务和 A/V 边缘服务使用相同的 FQDN 和 IP 地址。 如果是这样，你需要选择"使用单个 **FQDN** 和 IP 地址"复选框 (在下面的步骤 9 中记住) 
    
   - 如果计划启用联盟，请选中"为此边缘池启用联盟 (**端口 5061**) 复选框。
    
8. 单击"下一步"后，你将在 IP 选项 **屏幕上找到** 自己。 选项如下所示：
    
   - 在内部接口上启用 IPv4
    
   - 在内部接口上启用 IPv6
    
   - 在外部接口上启用 IPv4
    
   - 在外部接口上启用 IPv6
    
   无论你使用的是 IPv4 还是 IPv6 地址，这些地址都很容易理解，并且你要在边缘服务器上内部或外部应用这些地址 (在步骤 10) 中需要记住这一点。 还可以选择将边缘服务器或边缘池配置为使用外部 IP 地址的 NAT (NAT) 地址的网络地址转换。 为此，请选中 **"NAT"** 复选框转换此边缘池的外部 IP 地址。 准备就绪 **后** 单击"下一步"。
    
9. 在"外部 FQNS"屏幕上，您的选择取决于您在以上步骤 7 中所做的选择。
    
   - 如果选中了" **使用单个 FQDN** 和 IP 地址"复选框，则需要在 SIP 访问框中输入单个 **外部** FQDN。 然后，你需要为每个边缘服务输入不同的端口号，以允许它们相互独立连接。 建议 SIP 访问边缘服务为5061，建议 **为 Web** 会议边缘服务为 444，A/V边缘服务为 443。 完成后，单击 **“下一步”**。
    
   - 如果未选中"使用单个 **FQDN** 和 IP 地址"复选框，则现在将需要为 **SIP** 访问边缘服务 **、Web** 会议边缘服务和 **A/V** 边缘服务输入三个外部 FQDN。 完成后，单击 **“下一步”**。
    
10. 现在，您位于"定义 **内部 IP 地址"** 屏幕上。 在这里，你将在"内部 **IPv4** 地址"和"内部 **IPv6** 地址"文本框中键入边缘服务器的 IP 地址，具体取决于你在步骤 8 中所做的选择。 准备就绪 **后** 单击"下一步"。
    
11. 在 **"定义外部 IP 地址** "屏幕上，有一些选项取决于您之前的选择：
    
    - 您可以针对所有服务使用单个 FQDN。 如果是，请在 SIP 访问文本框中键入外部 IPv4 或 IPv6 (，) SIP **访问** 文本框中键入您的外部 IPv4 或 IPv6 **地址**。
    
    - 您可能已选择为服务使用三个单独的 FQDN 和 IP 地址。 如果是这种情况，请输入 **SIP** 访问边缘服务 **、Web** 会议边缘服务和 **A/V** 边缘服务的外部 IPv4 或 IPv6 地址，然后单击"下一步 **"。**
    
    > [!NOTE]
    > 如果之前未选择启用和分配 IPv6 寻址，则看不到此对话框。 这很正常，只需转到下一步。 
  
12. 如果在步骤 8 中选择重新使用 NAT，现在将看到一个包含公用 **IP** 地址文本框的屏幕。 你需要输入为 A/V 边缘服务设置的公共 IPv4 和/或 IPv6 地址，以通过 NAT 转换。 然后，单击“下一步”。
    
13. 下一个屏幕向上 **是"定义下一个跃点"。** 在 **"下一个** 跃点池"框中，选择内部池的名称，该名称可能是前端池或独立池。 如果环境中有控制器，应选择控制器。 然后，单击“下一步”。
    
14. 在 **"关联前端** 池"屏幕上，需要指定一个或多个内部池（包括前端池和 Standard Edition Server）以与此边缘服务器关联。 只需选择希望使用此边缘服务器与支持的外部用户进行通信的内部池的名称。 单击“**下一步**”。
    
    > [!NOTE]
    > 这里需要记住的一点就是，如果内部池或独立服务器已在使用不同的 Skype for Business Server 边缘服务器，则它们不能有多个关联。 如果选择处于该情况的内部池或独立服务器，将显示一条警告，告知您有关其他边缘服务器的信息，您可以决定是否要继续。 如果继续此新关联，则与其他边缘服务器的连接将停止。 
  
15. 单击 **下一** 个屏幕的"完成"。
    
16. 现在，你将能够发布此更新的技术，并按照 Skype for Business [Server](deploy-edge-servers.md) 中"部署边缘服务器"中的说明从此处部署到边缘服务器。
    
### <a name="defining-the-topology-for-a-dns-load-balanced-edge-server-pool"></a>定义 DNS 负载平衡边缘服务器池的拓扑

1. 登录到 Skype for Business Server Standard Edition Server 或 Skype for Business Server 前端服务器。
    
2. 一旦存在，打开 **Skype for Business Server 拓扑生成器**。
    
3. 在控制台树中，展开要部署边缘服务器的站点。
    
4. 右键单击 **边缘池**，然后单击 **"新建边缘池"。**
    
5. 你将 **在"定义** 新边缘池 **"屏幕上单击"下一步** "。
    
6. 在"定义边缘池 **FQDN"** 屏幕上，键入边缘池将使用的内部完全限定域名 (FQDN) ，然后选择"多计算机池"，完成后单击"下一步"。 
    
7. 在 **"选择功能** "屏幕上，可以选择：
    
    - 你可能打算对 SIP 访问服务、Skype for Business Server Web 会议服务和 A/V 边缘服务使用相同的 FQDN 和 IP 地址。 如果是这样，你需要选择"使用单个 **FQDN** 和 IP 地址"复选框 (在下面的步骤 9 中记住) 
    
    - 如果计划启用联盟，请选中"为此边缘池启用联盟 (**端口 5061**) 复选框。
    
8. 单击"下一步"后，你将在 IP 选项 **屏幕上找到** 自己。 选项如下所示：
    
    - 在内部接口上启用 IPv4
    
   - 在内部接口上启用 IPv6
    
   - 在外部接口上启用 IPv4
    
   - 在外部接口上启用 IPv6
    
     无论你使用的是 IPv4 还是 IPv6 地址，这些地址都很容易理解，并且你要在边缘服务器上内部或外部应用这些地址 (在步骤 11) 中需要记住这一点。 还可以选择将边缘服务器或边缘池配置为使用外部 IP 地址的 NAT (NAT) 地址的网络地址转换。 为此，请选中 **"NAT"** 复选框转换此边缘池的外部 IP 地址。 准备就绪 **后** 单击"下一步"。
    
9. 在"外部 FQNS"屏幕上，您的选择取决于您在以上步骤 7 中所做的选择。
    
   - 如果选中了" **使用单个 FQDN** 和 IP 地址"复选框，则需要在 SIP 访问框中输入单个 **外部** FQDN。 然后，你需要为每个边缘服务输入不同的端口号，以允许它们相互独立连接。 建议 SIP 访问边缘服务为5061，建议 **为 Web** 会议边缘服务为 444，A/V边缘服务为 443。 完成后，单击 **“下一步”**。
    
   - 如果未选中"使用单个 **FQDN** 和 IP 地址"复选框，则现在将需要为 **SIP** 访问边缘服务 **、Web** 会议边缘服务和 **A/V** 边缘服务输入三个外部 FQDN。 完成后，单击 **“下一步”**。
    
10. 现在你已到达"在此池 **屏幕中定义计算机"。** 单击“添加”按钮。
    
11. 现在，您位于"定义 **内部 IP 地址"** 屏幕上。 在这里，你将在"内部 **IPv4** 地址"和"内部 **IPv6** 地址"文本框中键入边缘服务器的 IP 地址，具体取决于你在步骤 8 中所做的选择。 准备就绪 **后** 单击"下一步"。
    
12. 在 **"定义外部 IP 地址** "屏幕上，有一些选项取决于您之前的选择：
    
    - 您可以针对所有服务使用单个 FQDN。 如果是，请在 SIP 访问文本框中键入外部 IPv4 或 IPv6 (，) SIP **访问** 文本框中键入您的外部 IPv4 或 IPv6 **地址**。
    
    - 您可能已选择为服务使用三个单独的 FQDN 和 IP 地址。 如果是这种情况，请输入 **SIP** 访问边缘服务 **、Web** 会议边缘服务和 **A/V** 边缘服务的外部 IPv4 或 IPv6 地址，然后单击"下一步 **"。**
    
    > [!NOTE]
    > 如果之前未选择启用和分配 IPv6 寻址，则看不到此对话框。 这很正常，只需转到下一步。 
  
13. 单击“完成”。 您刚刚创建的边缘服务器现在应列在"定义此池 **的计算机"** 对话框中。
    
14. 仍在"定义此池中的计算机"屏幕上，再次单击"添加"按钮，并重复步骤 11 至 13，直到添加要在此池中拥有的所有边缘服务器。 完成此操作后，单击"下一 **步"。**
    
15. 如果在步骤 8 中选择重新使用 NAT，现在将看到一个包含公用 **IP** 地址文本框的屏幕。 你需要输入为 A/V 边缘服务设置的公共 IPv4 和/或 IPv6 地址，以通过 NAT 转换。 然后，单击“下一步”。
    
16. 下一个屏幕向上 **是"定义下一个跃点"。** 在 **"下一个** 跃点池"框中，选择内部池的名称，该名称可能是前端池或独立池。 如果环境中有控制器，应选择控制器。 然后，单击“下一步”。
    
17. 在 **"关联前端** 池"屏幕上，需要指定一个或多个内部池（包括前端池和 Standard Edition 池）以与此边缘服务器关联。 只需选择希望使用此边缘服务器与支持的外部用户进行通信的内部池的名称。 单击“**下一步**”。
    
    > [!NOTE]
    > 这里需要记住的一点就是，如果内部池或独立服务器已在使用不同的 Skype for Business Server 边缘服务器，则它们不能有多个关联。 如果选择处于该情况的内部池或独立服务器，将显示一条警告，告知您有关其他边缘服务器的信息，您可以决定是否要继续。 如果继续此新关联，则与其他边缘服务器的连接将停止。 
  
18. 单击 **下一** 个屏幕的"完成"。
    
19. 现在，你将能够发布此更新的技术，并按照 Skype for Business [Server](deploy-edge-servers.md) 中"部署边缘服务器"中的说明从此处部署到边缘服务器。
    
### <a name="defining-the-topology-for-a-hardware-load-balanced-edge-server-pool"></a>定义硬件负载平衡边缘服务器池的拓扑

1. 登录到 Skype for Business Server Standard Edition Server 或 Skype for Business Server 前端服务器。
    
2. 一旦存在，打开 **Skype for Business Server 拓扑生成器**。
    
3. 在控制台树中，展开要部署边缘服务器的站点。
    
4. 右键单击 **边缘池**，然后单击 **"新建边缘池"。**
    
5. 你将 **在"定义** 新边缘池 **"屏幕上单击"下一步** "。
    
6. 在"定义边缘池 **FQDN"** 屏幕上，键入边缘池将使用的内部完全限定域名 (FQDN) ，然后选择"多计算机池"，完成后单击"下一步"。 
    
7. 在 **"选择功能** "屏幕上，可以选择：
    
   - 你可能打算对 SIP 访问服务、Skype for Business Server Web 会议服务和 A/V 边缘服务使用相同的 FQDN 和 IP 地址。 如果是这样，你需要选择"使用单个 **FQDN** 和 IP 地址"复选框 (在下面的步骤 9 中记住) 
    
   - 如果计划启用联盟，请选中"为此边缘池启用联盟 (**端口 5061**) 复选框。
    
8. 单击"下一步"后，你将在 IP 选项 **屏幕上找到** 自己。 选项如下所示：
    
   - 在内部接口上启用 IPv4
    
   - 在内部接口上启用 IPv6
    
   - 在外部接口上启用 IPv4
    
   - 在外部接口上启用 IPv6
    
     无论你使用的是 IPv4 还是 IPv6 地址，这些地址都很容易理解，并且你要在边缘服务器上内部或外部应用这些地址 (在步骤 11) 中需要记住这一点。
    
     > [!NOTE]
     > 与其他两个拓扑选项不同，在使用硬件负载平衡器时，不得选择选项边缘池的外部 **IP** 地址由 NAT 转换。 这 **不受支持**。
  
9. 在"外部 FQNS"屏幕上，您的选择取决于您在以上步骤 7 中所做的选择。
    
   - 如果选中了" **使用单个 FQDN** 和 IP 地址"复选框，则需要在 SIP 访问框中输入单个 **外部** FQDN。 然后，你需要为每个边缘服务输入不同的端口号，以允许它们相互独立连接。 建议 SIP 访问边缘服务为5061，建议 **为 Web** 会议边缘服务为 444，A/V边缘服务为 443。 完成后，单击 **“下一步”**。
    
   - 如果未选中"使用单个 **FQDN** 和 IP 地址"复选框，则现在将需要为 **SIP** 访问边缘服务 **、Web** 会议边缘服务和 **A/V** 边缘服务输入三个外部 FQDN。 完成后，单击 **“下一步”**。
    
10. 现在你已到达"在此池 **屏幕中定义计算机"。** 单击“添加”按钮。
    
11. 现在，您位于"定义 **内部 IP 地址"** 屏幕上。 在这里，你将在"内部 **IPv4** 地址"和"内部 **IPv6** 地址"文本框中键入边缘服务器的 IP 地址，具体取决于你在步骤 8 中所做的选择。 准备就绪 **后** 单击"下一步"。
    
12. 在 **"定义外部 IP 地址** "屏幕上，有一些选项取决于您之前的选择：
    
    - 您可以针对所有服务使用单个 FQDN。 如果是，请在 SIP 访问文本框中键入外部 IPv4 或 IPv6 (，) SIP **访问** 文本框中键入您的外部 IPv4 或 IPv6 **地址**。
    
    - 您可能已选择为服务使用三个单独的 FQDN 和 IP 地址。 如果是这种情况，请输入 **SIP** 访问边缘服务 **、Web** 会议边缘服务和 **A/V** 边缘服务的外部 IPv4 或 IPv6 地址，然后单击"下一步 **"。**
    
    > [!NOTE]
    > 如果之前未选择启用和分配 IPv6 寻址，则看不到此对话框。 这很正常，只需转到下一步。 
  
13. 单击“完成”。 您刚刚创建的边缘服务器现在应列在"定义此池 **的计算机"** 对话框中。
    
14. 仍在"定义此池中的计算机"屏幕上，再次单击"添加"按钮，并重复步骤 11 至 13，直到添加要在此池中拥有的所有边缘服务器。 完成此操作后，单击"下一 **步"。**
    
15. 下一个屏幕向上 **是"定义下一个跃点"。** 在 **"下一个** 跃点池"框中，选择内部池的名称，该名称可能是前端池或独立池。 如果环境中有控制器，应选择控制器。 然后，单击“下一步”。
    
16. 在 **"关联前端** 池"屏幕上，需要指定一个或多个内部池（包括前端池和 Standard Edition 池）以与此边缘服务器关联。 只需选择希望使用此边缘服务器与支持的外部用户进行通信的内部池的名称。 单击“**下一步**”。
    
    > [!NOTE]
    > 这里需要记住的一点就是，如果内部池或独立服务器已在使用不同的 Skype for Business Server 边缘服务器，则它们不能有多个关联。 如果选择处于该情况的内部池或独立服务器，将显示一条警告，告知您有关其他边缘服务器的信息，您可以决定是否要继续。 如果继续此新关联，则与其他边缘服务器的连接将停止。 
  
17. 单击 **下一** 个屏幕的"完成"。
    
18. 现在，你将能够发布此更新的技术，并按照 Skype for Business [Server](deploy-edge-servers.md) 中"部署边缘服务器"中的说明从此处部署到边缘服务器。
    
## <a name="publish-your-edge-server-topology"></a>发布边缘服务器拓扑

完成上述步骤后，可以发布此新拓扑，这也允许你将其导出到 Skype for Business Server 边缘服务器或边缘池。 请按以下步骤操作：
  
1. 如果 **拓扑生成器** (上一过程尚未启动，请启动拓扑生成器) 。
    
2. 在 **拓扑生成器的** 控制台树中，右键单击 **Skype for Business Server，** 然后单击 Skype for Business Server **拓扑生成器**。
    
3. 在向导的“欢迎”页上，单击“下一步”。
    
4. 在“创建其他数据库”页上，单击“下一步”。
    
5. 当状态指示数据库创建成功时，请执行下列操作：
    
    - 要查看日志，请单击“查看日志”。
    
    - 要关闭向导，请单击“完成”。
    
## <a name="export-your-edge-server-topology"></a>导出边缘服务器拓扑

若要成功部署，Skype for Business Server 部署向导需要访问中央管理存储数据。 对于域或林中的内部服务器，这通常很简单。 边缘服务器位于域之外，因此有必要手动将拓扑文件导出到边缘服务器位置，通常位于物理媒体上。 此导出通过 PowerShell 完成：
  
1. 启动 **Skype for Business Server 命令行管理程序**。
    
2. 在 **Skype for Business Server 命令行管理程序** 中，运行以下命令：
    
   ```powershell
   Export-CsConfiguration -FileName <ConfigurationFilePath.zip>
   ```

3. 将导出的文件复制到外部媒体 (例如，可以从边缘服务器的位置访问的 USB 驱动器或网络) 。
    

