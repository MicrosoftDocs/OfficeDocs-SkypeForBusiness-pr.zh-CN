---
title: 为 Skype for Business 服务器创建边缘拓扑
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
audience: ITPro
ms.topic: quickstart
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection:
- Strat_SB_Hybrid
ms.custom: ''
ms.assetid: 5ea18841-afdc-4ccb-8d86-30584c1f5aca
description: 摘要：了解如何在 Skype for Business Server 中构建、发布和导出 Edge 服务器拓扑。
ms.openlocfilehash: 3abde687899f240174e91d2583321bcdc6855fff
ms.sourcegitcommit: dd3a3ab4ddbdcfe772f30fb01ba3b97c45c43dd4
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/04/2020
ms.locfileid: "41768325"
---
# <a name="create-your-edge-topology-for-skype-for-business-server"></a>为 Skype for Business 服务器创建边缘拓扑
 
**摘要：** 了解如何在 Skype for Business 服务器中构建、发布和导出 Edge 服务器拓扑。
  
拓扑生成器是你需要用于构建边缘服务器拓扑的工具，就像它用于 Skype for Business 服务器的任何拓扑组件一样。 在执行以下步骤之前，你将需要至少设置一个前端池或标准版服务器。
  
我们将在本文中介绍以下主题：
  
- 构建边缘服务器拓扑
    
- 发布边缘服务器拓扑
    
- 验证边缘服务器拓扑
    
  > [!NOTE]
  > 为了遵循下面的步骤，需要登录到下面提及的域服务器，且用来登录的用户应该是以下域组的成员： 
  
- RTCUniversalServerAdmins
    
- Domain Admins
    
## <a name="build-your-edge-server-topology"></a>构建边缘服务器拓扑

第一个部署步骤是构建您的 Skype for Business Server Edge 服务器拓扑，它包含以下三个选项之一：
  
- 单个边缘服务器
    
- DNS 负载平衡的边缘池（一个或多个服务器）
    
- 硬件负载平衡的边缘池（一个或多个服务器）
    
如果不确定自己需要哪种选项，那么在开始遵循这些步骤之前，最好先重温规划文档。否则，让我们开始。
  
### <a name="defining-the-topology-for-a-single-edge-server"></a>定义单个边缘服务器的拓扑

1. 登录到 Skype for business Server Standard Edition 服务器或 Skype for business 服务器前端池。
    
2. 在此之后，打开**Skype For Business 服务器拓扑生成器**。
    
3. 在控制台树中，展开你要将边缘服务器部署到的网站。
    
4. 右键单击 "**边缘池**"，然后单击 "**新建边缘池**"。
    
5. 您将在 "**定义新的边缘池**" 屏幕上单击 "**下一步**"。
    
6. 在 "**定义边缘池 FQDN** " 屏幕上，键入边缘服务器将要使用的内部完全限定的域名（FQDN），然后选择 "**单个计算机池**"，完成后单击 "**下一步**"。
    
7. 在“**选择功能**”屏幕上，可选择：
    
   - 你可能想要对你的 SIP 访问服务、Skype for Business Server Web 会议服务和你的 A/V 边缘服务使用相同的 FQDN 和 IP 地址。 如果是这样，需要选中“**使用一个 FQDN 和 IP 地址**”复选框（做到下面的步骤 9 时，请记得这一点）
    
   - 如果你计划启用联盟，请选中“**为此边缘池启用联盟(端口 5061)**”复选框。
    
8. 单击“**下一步**”后，你将进入“**IP 选项**”屏幕。选项如下：
    
   - 在内部接口上启用 IPv4
    
   - 在内部接口上启用 IPv6
    
   - 在外部接口上启用 IPv4
    
   - 在外部接口上启用 IPv6
    
   无论您使用的是 IPv4 还是 IPv6 地址，这些地址都是一目了然的，而是在您的边缘服务器内部或外部应用这些地址（在步骤10中需要记住这一点）。 你还可以选择将 Edge 服务器或边缘池配置为对外部 IP 地址使用网络地址转换（NAT）地址。 选中“**此边缘池的外部 IP 地址是由 NAT 转换的**”复选框可以执行此配置。 完成后，单击“**下一步**”。
    
9. 在“外部 FQDN”屏幕上，你的选择取决于你在上面的步骤 7 中所作的选择。
    
   - 如果选中 "**使用单个 FQDN 和 IP 地址**" 复选框，则需要在 " **SIP 访问**" 框中输入您的单个外部 FQDN。 然后，你需要为每个 edge 服务输入不同的端口号，以允许它们单独连接。 我们建议 **SIP 访问**边缘服务使用 5061，**Web 会议**边缘服务使用 444，**A/V** 边缘服务使用 443。 完成后单击“**下一步**”。
    
   - 如果未选中 "**使用单个 FQDN 和 IP 地址**" 复选框，则现在需要为**SIP Access** Edge 服务、 **Web 会议**Edge 服务和**a/V**边缘服务输入三个外部 fqdn。 完成后，单击“**下一步**”。
    
10. 您现在位于 "**定义内部 IP 地址**" 屏幕。 在此处，你将在 "**内部 IPv4 地址**" 和 "**内部 IPv6 地址**" 文本框中键入边缘服务器的 IP 地址，具体取决于在步骤8中所做的选择。 完成后单击“**下一步**”。
    
11. 在“**定义外部 IP 地址**”屏幕上，根据你前面的选择，有几个选项：
    
    - 你可能让所有服务使用一个 FQDN。 如果是这样，请在 " **SIP Access** " 文本框中键入您的外部 IPv4 或 IPv6 地址（无论使用哪种地址），然后单击 "**下一步**"。
    
    - 你可能选择让这些服务使用三个不同的 FQDN 和 IP 地址。 如果是这种情况，请为**SIP 访问**边缘服务输入您的外部 IPv4 或 IPv6 地址、 **Web 会议**边缘服务和**A/V**边缘服务，然后单击 "**下一步**"。
    
    > [!NOTE]
    > 如果先前未选择启用和分配 IPv6 编址，则不会出现此对话框。这是正常现象，请直接进入下一步。 
  
12. 如果您选择在步骤8中使用 NAT，您现在将获得一个包含 "**公共 IP 地址**" 文本框的屏幕。 你需要输入为 A/V 边缘服务设置的公共 IPv4 和/或 IPv6 地址，以便通过 NAT 进行转换。 然后单击“**下一步**”。
    
13. 接下来的屏幕是“**定义下一跃点**”。 在**下一个 "跃点池**" 框中，选择你的内部池的名称，该名称可能是前端池或独立池。 如果你的环境中有控制器，你应该选择 Director。 然后单击" **下一步**"。
    
14. 在 "**关联前端池**" 屏幕上，你需要指定一个或多个内部池（包括前端池和标准版服务器），以便与此边缘服务器关联。 只需选择要使用此 Edge 服务器与受支持的外部用户进行通信的内部池的名称。 单击" **下一步**"。
    
    > [!NOTE]
    > 此处应注意的是，如果内部池或独立服务器已使用不同的 Skype for Business 服务器 Edge 服务器，则它们不能有多个关联。 如果你选择在这种情况下出现的内部池或独立服务器，你将看到一条警告，告诉你其他边缘服务器，你可以决定是否要继续。 如果继续这个新的关联，与另一台边缘服务器的连接将停止。 
  
15. 在下一个屏幕上单击“**完成**”。
    
16. 现在，你将能够发布此更新的技术，并按照 " [Skype For business" 服务器的部署边缘服务器](deploy-edge-servers.md)中的说明从此处部署到 Edge 服务器。
    
### <a name="defining-the-topology-for-a-dns-load-balanced-edge-server-pool"></a>定义 DNS 负载平衡边缘服务器池的拓扑

1. 登录到 Skype for business Server Standard Edition 服务器或 Skype for business 服务器前端服务器。
    
2. 在此之后，打开**Skype For Business 服务器拓扑生成器**。
    
3. 在控制台树中，展开你要将边缘服务器部署到的网站。
    
4. 右键单击 "**边缘池**"，然后单击 "**新建边缘池**"。
    
5. 您将在 "**定义新的边缘池**" 屏幕上单击 "**下一步**"。
    
6. 在 "**定义边缘池 FQDN** " 屏幕上，键入边缘池要使用的内部完全限定的域名（FQDN），然后选择 "完成时单击 '**下一个**'**计算机池**"。
    
7. 在“**选择功能**”屏幕上，可选择：
    
    - 你可能想要对你的 SIP 访问服务、Skype for Business Server Web 会议服务和你的 A/V 边缘服务使用相同的 FQDN 和 IP 地址。 如果是这样，需要选中“**使用一个 FQDN 和 IP 地址**”复选框（做到下面的步骤 9 时，请记得这一点）
    
    - 如果你计划启用联盟，请选中“**为此边缘池启用联盟(端口 5061)**”复选框。
    
8. 单击“**下一步**”后，你将进入“**IP 选项**”屏幕。选项如下：
    
    - 在内部接口上启用 IPv4
    
   - 在内部接口上启用 IPv6
    
   - 在外部接口上启用 IPv4
    
   - 在外部接口上启用 IPv6
    
     无论您使用的是 IPv4 还是 IPv6 地址，这些地址都是一目了然的，而是在您的边缘服务器内部或外部应用这些地址（在步骤11中需要记住这一点）。 你还可以选择将 Edge 服务器或边缘池配置为对外部 IP 地址使用网络地址转换（NAT）地址。 选中“**此边缘池的外部 IP 地址是由 NAT 转换的**”复选框可以执行此配置。 完成后，单击“**下一步**”。
    
9. 在“外部 FQDN”屏幕上，你的选择取决于你在上面的步骤 7 中所作的选择。
    
   - 如果选中 "**使用单个 FQDN 和 IP 地址**" 复选框，则需要在 " **SIP 访问**" 框中输入您的单个外部 FQDN。 然后，你需要为每个 edge 服务输入不同的端口号，以允许它们单独连接。 我们建议 **SIP 访问**边缘服务使用 5061，**Web 会议**边缘服务使用 444，**A/V** 边缘服务使用 443。 完成后单击“**下一步**”。
    
   - 如果未选中 "**使用单个 FQDN 和 IP 地址**" 复选框，则现在需要为**SIP Access** Edge 服务、 **Web 会议**Edge 服务和**a/V**边缘服务输入三个外部 fqdn。 完成后，单击“**下一步**”。
    
10. 现在，你已达到 "**在此池中定义计算机**" 屏幕。 单击“**添加**”按钮。
    
11. 您现在位于 "**定义内部 IP 地址**" 屏幕。 在此处，你将在 "**内部 IPv4 地址**" 和 "**内部 IPv6 地址**" 文本框中键入边缘服务器的 IP 地址，具体取决于在步骤8中所做的选择。 完成后单击“**下一步**”。
    
12. 在“**定义外部 IP 地址**”屏幕上，根据你前面的选择，有几个选项：
    
    - 你可能让所有服务使用一个 FQDN。 如果是这样，请在 " **SIP Access** " 文本框中键入您的外部 IPv4 或 IPv6 地址（无论使用哪种地址），然后单击 "**下一步**"。
    
    - 你可能选择让这些服务使用三个不同的 FQDN 和 IP 地址。 如果是这种情况，请为**SIP 访问**边缘服务输入您的外部 IPv4 或 IPv6 地址、 **Web 会议**边缘服务和**A/V**边缘服务，然后单击 "**下一步**"。
    
    > [!NOTE]
    > 如果先前未选择启用和分配 IPv6 编址，则不会出现此对话框。这是正常现象，请直接进入下一步。 
  
13. 单击“**完成**”。 您刚刚创建的边缘服务器现在应在 "**定义计算机在此池中"** 对话框中列出。
    
14. 仍在 "**在此池内定义计算机**" 屏幕中，再次单击 "**添加**" 按钮，然后重复步骤11至13，直到添加了要在该池中拥有的所有边缘服务器。 完成后，单击“**下一步**”。
    
15. 如果您选择在步骤8中使用 NAT，您现在将获得一个包含 "**公共 IP 地址**" 文本框的屏幕。 你需要输入为 A/V 边缘服务设置的公共 IPv4 和/或 IPv6 地址，以便通过 NAT 进行转换。 然后单击“**下一步**”。
    
16. 接下来的屏幕是“**定义下一跃点**”。 在**下一个 "跃点池**" 框中，选择你的内部池的名称，该名称可能是前端池或独立池。 如果你的环境中有控制器，你应该选择 Director。 然后单击" **下一步**"。
    
17. 在 "**关联前端池**" 屏幕上，你需要指定一个或多个内部池（包括前端池和标准版池），以便与此边缘服务器相关联。 只需选择要使用此 Edge 服务器与受支持的外部用户进行通信的内部池的名称。 单击" **下一步**"。
    
    > [!NOTE]
    > 此处应注意的是，如果内部池或独立服务器已使用不同的 Skype for Business 服务器 Edge 服务器，则它们不能有多个关联。 如果你选择在这种情况下出现的内部池或独立服务器，你将看到一条警告，告诉你其他边缘服务器，你可以决定是否要继续。 如果继续这个新的关联，与另一台边缘服务器的连接将停止。 
  
18. 在下一个屏幕上单击“**完成**”。
    
19. 现在，你将能够发布此更新的技术，并按照 " [Skype For business" 服务器的部署边缘服务器](deploy-edge-servers.md)中的说明从此处部署到 Edge 服务器。
    
### <a name="defining-the-topology-for-a-hardware-load-balanced-edge-server-pool"></a>定义硬件负载平衡的边缘服务器池的拓扑

1. 登录到 Skype for business Server Standard Edition 服务器或 Skype for business 服务器前端服务器。
    
2. 在此之后，打开**Skype For Business 服务器拓扑生成器**。
    
3. 在控制台树中，展开你要将边缘服务器部署到的网站。
    
4. 右键单击 "**边缘池**"，然后单击 "**新建边缘池**"。
    
5. 您将在 "**定义新的边缘池**" 屏幕上单击 "**下一步**"。
    
6. 在 "**定义边缘池 FQDN** " 屏幕上，键入边缘池要使用的内部完全限定的域名（FQDN），然后选择 "完成时单击 '**下一个**'**计算机池**"。
    
7. 在“**选择功能**”屏幕上，可选择：
    
   - 你可能想要对你的 SIP 访问服务、Skype for Business Server Web 会议服务和你的 A/V 边缘服务使用相同的 FQDN 和 IP 地址。 如果是这样，需要选中“**使用一个 FQDN 和 IP 地址**”复选框（做到下面的步骤 9 时，请记得这一点）
    
   - 如果你计划启用联盟，请选中“**为此边缘池启用联盟(端口 5061)**”复选框。
    
8. 单击“**下一步**”后，你将进入“**IP 选项**”屏幕。选项如下：
    
   - 在内部接口上启用 IPv4
    
   - 在内部接口上启用 IPv6
    
   - 在外部接口上启用 IPv4
    
   - 在外部接口上启用 IPv6
    
     无论您使用的是 IPv4 还是 IPv6 地址，这些地址都是一目了然的，而是在您的边缘服务器内部或外部应用这些地址（在步骤11中需要记住这一点）。
    
     > [!NOTE]
     > 与其他两个拓扑选项不同，使用硬件负载平衡器时，您**不能**选择 "选项 **" 选项：由 NAT 转换边缘池的外部 IP 地址**。 这**不受支持**。
  
9. 在“外部 FQDN”屏幕上，你的选择取决于你在上面的步骤 7 中所作的选择。
    
   - 如果选中 "**使用单个 FQDN 和 IP 地址**" 复选框，则需要在 " **SIP 访问**" 框中输入您的单个外部 FQDN。 然后，你需要为每个 edge 服务输入不同的端口号，以允许它们单独连接。 我们建议 **SIP 访问**边缘服务使用 5061，**Web 会议**边缘服务使用 444，**A/V** 边缘服务使用 443。 完成后单击“**下一步**”。
    
   - 如果未选中 "**使用单个 FQDN 和 IP 地址**" 复选框，则现在需要为**SIP Access** Edge 服务、 **Web 会议**Edge 服务和**a/V**边缘服务输入三个外部 fqdn。 完成后，单击“**下一步**”。
    
10. 现在，你已达到 "**在此池中定义计算机**" 屏幕。 单击“**添加**”按钮。
    
11. 您现在位于 "**定义内部 IP 地址**" 屏幕。 在此处，你将在 "**内部 IPv4 地址**" 和 "**内部 IPv6 地址**" 文本框中键入边缘服务器的 IP 地址，具体取决于在步骤8中所做的选择。 完成后单击“**下一步**”。
    
12. 在“**定义外部 IP 地址**”屏幕上，根据你前面的选择，有几个选项：
    
    - 你可能让所有服务使用一个 FQDN。 如果是这样，请在 " **SIP Access** " 文本框中键入您的外部 IPv4 或 IPv6 地址（无论使用哪种地址），然后单击 "**下一步**"。
    
    - 你可能选择让这些服务使用三个不同的 FQDN 和 IP 地址。 如果是这种情况，请为**SIP 访问**边缘服务输入您的外部 IPv4 或 IPv6 地址、 **Web 会议**边缘服务和**A/V**边缘服务，然后单击 "**下一步**"。
    
    > [!NOTE]
    > 如果先前未选择启用和分配 IPv6 编址，则不会出现此对话框。这是正常现象，请直接进入下一步。 
  
13. 单击“**完成**”。 您刚刚创建的边缘服务器现在应在 "**定义计算机在此池中"** 对话框中列出。
    
14. 仍在 "**在此池内定义计算机**" 屏幕中，再次单击 "**添加**" 按钮，然后重复步骤11至13，直到添加了要在该池中拥有的所有边缘服务器。 完成后，单击“**下一步**”。
    
15. 接下来的屏幕是“**定义下一跃点**”。 在**下一个 "跃点池**" 框中，选择你的内部池的名称，该名称可能是前端池或独立池。 如果你的环境中有控制器，你应该选择 Director。 然后单击" **下一步**"。
    
16. 在 "**关联前端池**" 屏幕上，你需要指定一个或多个内部池（包括前端池和标准版池），以便与此边缘服务器相关联。 只需选择要使用此 Edge 服务器与受支持的外部用户进行通信的内部池的名称。 单击" **下一步**"。
    
    > [!NOTE]
    > 此处应注意的是，如果内部池或独立服务器已使用不同的 Skype for Business 服务器 Edge 服务器，则它们不能有多个关联。 如果你选择在这种情况下出现的内部池或独立服务器，你将看到一条警告，告诉你其他边缘服务器，你可以决定是否要继续。 如果继续这个新的关联，与另一台边缘服务器的连接将停止。 
  
17. 在下一个屏幕上单击“**完成**”。
    
18. 现在，你将能够发布此更新的技术，并按照 " [Skype For business" 服务器的部署边缘服务器](deploy-edge-servers.md)中的说明从此处部署到 Edge 服务器。
    
## <a name="publish-your-edge-server-topology"></a>发布边缘服务器拓扑

完成上述步骤后，就可以发布此新拓扑，这还将允许你将其导出到 Skype for Business Server Edge 服务器或边缘池。 请按以下步骤执行：
  
1. 启动“**拓扑生成器**”（如果在前面的过程中还未启动）。
    
2. 在**拓扑生成器**的控制台树中，右键单击 " **Skype for business 服务器**"，然后单击 " **Skype for business 服务器拓扑生成器**"。
    
3. 在向导的“**欢迎**”页上，单击“**下一步**”。
    
4. 在“**创建其他数据库**”页上，单击“**下一步**”。
    
5. 当状态指示数据库创建成功时，执行以下操作：
    
    - 若要查看日志，请单击“**查看日志**”。
    
    - 若要关闭向导，请单击“**完成**”。
    
## <a name="export-your-edge-server-topology"></a>验证边缘服务器拓扑

若要成功部署，Skype for Business 服务器部署向导需要访问中央管理存储数据。 对于域或林中的内部服务器，这通常很容易。 边缘服务器位于域之外，因此需要手动将拓扑文件导出到边缘服务器位置，通常在物理媒体上。 这样的导出通过 PowerShell 执行：
  
1. 启动**Skype For Business Server 命令行管理程序**。
    
2. 在**Skype For Business Server 命令行管理**程序中，运行以下命令：
    
   ```powershell
   Export-CsConfiguration -FileName <ConfigurationFilePath.zip>
   ```

3. 将导出的文件复制到外部媒体（例如，可从边缘服务器位置访问的 USB 驱动器或网络共享）。
    

