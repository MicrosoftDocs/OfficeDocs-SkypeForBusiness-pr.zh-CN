---
title: 获取 Microsoft Teams 的客户端
author: LolaJacobsen
ms.author: lolaj
manager: serdars
ms.date: 04/25/2019
audience: Admin
ms.topic: article
ms.service: msteams
ms.collection:
- Teams_ITAdmin_Help
- M365-collaboration
ms.reviewer: harij, rafarhi
localization_priority: Normal
search.appverid: MET150
description: 了解如何使用支持 Microsoft Teams 的各种客户端，包括 Web、桌面（Windows 和 Mac）和移动（Android 和 iOS）。
ms.custom:
- NewAdminCenter_Update
appliesto:
- Microsoft Teams
ms.openlocfilehash: 646305383c8f38671c07f598bc9ff1671890d22f
ms.sourcegitcommit: 3c40bdd228ef88967cdf689100f2030f6997d9d5
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/03/2019
ms.locfileid: "36715796"
---
<a name="get-clients-for-microsoft-teams"></a><span data-ttu-id="dfb31-103">获取 Microsoft Teams 的客户端</span><span class="sxs-lookup"><span data-stu-id="dfb31-103">Get clients for Microsoft Teams</span></span> 
===========================

<span data-ttu-id="dfb31-104">支持 Microsoft Teams 的客户端包括桌面（Windows 和 Mac）、Web 和移动（Android 和 iOS）。</span><span class="sxs-lookup"><span data-stu-id="dfb31-104">Microsoft Teams has clients available for web, desktop (Windows and Mac), and mobile (Android, iOS, and Windows Phone).</span></span> <span data-ttu-id="dfb31-105">这些客户端都要求有活动的 Internet 连接，不支持脱机模式。</span><span class="sxs-lookup"><span data-stu-id="dfb31-105">These clients all require an active internet connection and do not support an offline mode.</span></span>

> [!NOTE]
> <span data-ttu-id="dfb31-106">自 2018 年 11 月 29 日起，用户将不再能够使用 Microsoft Store 提供的 Microsoft Teams for Windows 10 S（预览版）应用。</span><span class="sxs-lookup"><span data-stu-id="dfb31-106">Effective November 29, 2018, you'll no longer be able to use the Microsoft Teams for Windows 10 S (Preview) app, available from the Microsoft Store.</span></span> <span data-ttu-id="dfb31-107">现在，可以在运行 Windows 10 S 模式的设备上下载并安装 Teams 桌面客户端。</span><span class="sxs-lookup"><span data-stu-id="dfb31-107">Instead, you can now download and install the Teams desktop client on devices running Windows 10 S mode.</span></span> <span data-ttu-id="dfb31-108">若要下载桌面客户端，请转到 [https://teams.microsoft.com/downloads](https://go.microsoft.com/fwlink/?linkid=855754)。</span><span class="sxs-lookup"><span data-stu-id="dfb31-108">To download the desktop client, go to [https://teams.microsoft.com/downloads](https://go.microsoft.com/fwlink/?linkid=855754).</span></span> <span data-ttu-id="dfb31-109">Teams 桌面客户端的 MSI 内部版本尚不适用于运行 Windows 10 S 模式的设备。</span><span class="sxs-lookup"><span data-stu-id="dfb31-109">MSI builds of the Teams desktop client are not yet available for devices running Windows 10 S mode.</span></span>
>
> <span data-ttu-id="dfb31-110">有关 Windows 10 S 模式的详细信息，请参阅 [Windows 10 S 模式简介](https://www.microsoft.com/windows/s-mode)。</span><span class="sxs-lookup"><span data-stu-id="dfb31-110">For more information about Windows 10 S mode, see [Introducing Windows 10 in S mode](https://www.microsoft.com/windows/s-mode).</span></span> 

<a name="desktop-client"></a><span data-ttu-id="dfb31-111">桌面客户端</span><span class="sxs-lookup"><span data-stu-id="dfb31-111">Desktop client</span></span>
--------------

> [!Tip]
> <span data-ttu-id="dfb31-112">观看以下会话以了解 Windows 桌面客户端的优势，如何规划它，以及如何部署它：[Teams Windows 桌面客户端](https://aka.ms/teams-clients)</span><span class="sxs-lookup"><span data-stu-id="dfb31-112">Watch the following session to learn about the benefits of the Windows Desktop Client, how to plan for it, and how to deploy it: [Teams Windows Desktop Client](https://aka.ms/teams-clients)</span></span>

<span data-ttu-id="dfb31-113">Microsoft Teams 桌面客户端是独立的应用程序，也[可以在 Office 365 专业增强版中使用](https://docs.microsoft.com/zh-CN/deployoffice/teams-install)。</span><span class="sxs-lookup"><span data-stu-id="dfb31-113">The Microsoft Teams desktop client is a standalone application and is also [available in Office 365 ProPlus](https://docs.microsoft.com/zh-CN/deployoffice/teams-install).</span></span> <span data-ttu-id="dfb31-114">Teams 适用于 Windows (7+)（32 位和 64 位版本）和 macOS (10.10+)。</span><span class="sxs-lookup"><span data-stu-id="dfb31-114">Microsoft Teams is available for both Windows (7+), both 32-bit and 64-bit versions, and MacOS (10.10+).</span></span> <span data-ttu-id="dfb31-115">在 Windows 上，Teams 需要 .NET Framework 4.5 或更高版本；如果没有，Teams 安装程序将为你安装。</span><span class="sxs-lookup"><span data-stu-id="dfb31-115">On Windows, Teams requires .NET Framework 4.5 or later; the Teams installer will offer to install it for you if you don't have it.</span></span> 

<span data-ttu-id="dfb31-116">桌面客户端为团队会议、群组通话和专线一对一呼叫提供实时通信支持（音频、视频和内容共享）。</span><span class="sxs-lookup"><span data-stu-id="dfb31-116">The desktop clients provide real-time communications support (audio, video, and content sharing) for team meetings, group calling and private one-on-one calls.</span></span>

<span data-ttu-id="dfb31-117">如果最终用户有合适的本地权限（在 PC 上安装 Teams 客户端不需要管理权限，但在 Mac 上需要），可以直接从 [https://teams.microsoft.com/downloads](https://go.microsoft.com/fwlink/?linkid=855754) 下载并安装桌面客户端。</span><span class="sxs-lookup"><span data-stu-id="dfb31-117">Desktop clients can be downloaded and installed by end users directly from https://teams.microsoft.com/downloads if they have the appropriate local permissions (admin rights are not required to install the Teams client on a PC but are required on a Mac).</span></span>

<span data-ttu-id="dfb31-118">IT 管理员可以选择其首选方法将安装文件分发到其组织中的计算机上，例如 System Center Configuration Manager (Windows) 或 Jamf Pro (macOS)。</span><span class="sxs-lookup"><span data-stu-id="dfb31-118">IT admins can choose their preferred method to distribute the installation files to machines in their organization such as System Center Configuration Manager (Windows) or Casper Suite (MacOS).</span></span> <span data-ttu-id="dfb31-119">若要获取用于 Windows 分发的 MSI 包，请参阅[使用 MSI 安装 Microsoft Teams](msi-deployment.md)。</span><span class="sxs-lookup"><span data-stu-id="dfb31-119">To get the MSI package for Windows distribution, see [Install Microsoft Teams using MSI](msi-deployment.md).</span></span>  

> [!NOTE]
> <span data-ttu-id="dfb31-120">通过这些机制分发客户端仅适用于初次安装 Microsoft Team 客户端，不适用于将来更新。</span><span class="sxs-lookup"><span data-stu-id="dfb31-120">Distribution of the client via these mechanisms is only for the initial installation of Microsoft Team clients and not for future updates.</span></span>

### <a name="windows"></a><span data-ttu-id="dfb31-121">Windows</span><span class="sxs-lookup"><span data-stu-id="dfb31-121">Windows</span></span>

<span data-ttu-id="dfb31-122">适用于 Windows 的 Microsoft Teams 安装提供 32 位和 64 位体系结构的可下载安装程序。</span><span class="sxs-lookup"><span data-stu-id="dfb31-122">The Microsoft Teams installation for Windows provides downloadable installers in 32-bit and 64-bit architecture.</span></span>

> [!NOTE]
> <span data-ttu-id="dfb31-123">安装的 Windows 和 Office 的体系结构不限制 Microsoft Teams 的体系结构（32 位和 64 位）。</span><span class="sxs-lookup"><span data-stu-id="dfb31-123">The architecture (32-bit vs. 64-bit) of Microsoft Teams is agnostic to the architecture of Office that is installed.</span></span>

<span data-ttu-id="dfb31-124">Windows 客户端部署到位于用户配置文件中的 AppData 文件夹中。</span><span class="sxs-lookup"><span data-stu-id="dfb31-124">The Windows client is deployed to the AppData folder located in the user’s profile.</span></span> <span data-ttu-id="dfb31-125">部署到用户的本地配置文件后，无需提升的权限即可安装客户端。</span><span class="sxs-lookup"><span data-stu-id="dfb31-125">Deploying to the user’s local profile allows the client to be installed without requiring elevated rights.</span></span> <span data-ttu-id="dfb31-126">Windows 客户端会利用以下位置：</span><span class="sxs-lookup"><span data-stu-id="dfb31-126">The Windows client is installed in the following locations:</span></span>

- <span data-ttu-id="dfb31-127">%LocalAppData%\\Microsoft\\Teams</span><span class="sxs-lookup"><span data-stu-id="dfb31-127">%LocalAppData%\\Microsoft\\Teams</span></span>

- <span data-ttu-id="dfb31-128">%LocalAppData%\\Microsoft\\TeamsMeetingsAddin</span><span class="sxs-lookup"><span data-stu-id="dfb31-128">%LocalAppData%\\Microsoft\\TeamsMeetingsAddin</span></span>

- <span data-ttu-id="dfb31-129">%AppData%\\Microsoft\\Teams</span><span class="sxs-lookup"><span data-stu-id="dfb31-129">%AppData%\\Microsoft\\Teams</span></span>

- <span data-ttu-id="dfb31-130">%LocalAppData%\\SquirrelTemp</span><span class="sxs-lookup"><span data-stu-id="dfb31-130">%LocalAppData%\\SquirrelTemp</span></span>

<span data-ttu-id="dfb31-131">用户首次使用 Microsoft Teams 客户端启动呼叫时，他们可能会注意到有关 Windows 防火墙设置的警告，要求用户允许通信。</span><span class="sxs-lookup"><span data-stu-id="dfb31-131">When users initiate a call using the Microsoft Teams client for the first time, they might notice a warning with the Windows firewall settings that asks for users to allow communication.</span></span> <span data-ttu-id="dfb31-132">可以指示用户忽略此消息，因为即使忽略此警告，也可以进行呼叫。</span><span class="sxs-lookup"><span data-stu-id="dfb31-132">Users may be instructed to ignore this message because the call will work, even when the warning is dismissed.</span></span>

![Windows 安全警报对话框屏幕截图。](media/Get_clients_for_Microsoft_Teams_image3.png)

> [!NOTE]
> <span data-ttu-id="dfb31-134">即使选择“取消”忽略该提示，也将会更改 Windows 防火墙配置。</span><span class="sxs-lookup"><span data-stu-id="dfb31-134">Windows Firewall configuration will be altered even when the prompt is dismissed by selecting “Cancel”.</span></span> <span data-ttu-id="dfb31-135">将会创建两条针对 teams.exe 的入站规则，操作是阻止 TCP 和 UDP 协议。</span><span class="sxs-lookup"><span data-stu-id="dfb31-135">Two inbound rules for teams.exe will be created with Block action for both TCP and UDP protocols.</span></span>

### <a name="mac"></a><span data-ttu-id="dfb31-136">Mac</span><span class="sxs-lookup"><span data-stu-id="dfb31-136">Mac</span></span>

<span data-ttu-id="dfb31-137">Mac 用户可以使用 macOS 计算机的 PKG 安装文件安装 Teams。</span><span class="sxs-lookup"><span data-stu-id="dfb31-137">Mac users can install Teams by using a PKG installation file for macOS computers.</span></span> <span data-ttu-id="dfb31-138">安装 Mac 客户端需要管理访问权限。</span><span class="sxs-lookup"><span data-stu-id="dfb31-138">Administrative access is required to install the Mac client.</span></span> <span data-ttu-id="dfb31-139">将 macOS 客户端安装到 /Applications 文件夹中。</span><span class="sxs-lookup"><span data-stu-id="dfb31-139">The Mac OSX client is installed to the /Applications folder.</span></span>

#### <a name="install-teams-by-using-the-pkg-file"></a><span data-ttu-id="dfb31-140">使用 PKG 文件安装 Teams</span><span class="sxs-lookup"><span data-stu-id="dfb31-140">Install Teams by using the PKG file</span></span>

1. <span data-ttu-id="dfb31-141">在 **Mac** 下的 [Teams下载页面](https://teams.microsoft.com/downloads)中，单击“下载”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="dfb31-141">From the [Teams download page](https://teams.microsoft.com/downloads), under **Mac**, click **Download**.</span></span>
2. <span data-ttu-id="dfb31-142">双击 PKG 文件。</span><span class="sxs-lookup"><span data-stu-id="dfb31-142">Double click the PKG file.</span></span>
3. <span data-ttu-id="dfb31-143">按照安装向导的说明完成安装。</span><span class="sxs-lookup"><span data-stu-id="dfb31-143">Follow the installation wizard to complete the installation.</span></span>
4. <span data-ttu-id="dfb31-144">Teams 将安装到 /Applications 文件夹中。</span><span class="sxs-lookup"><span data-stu-id="dfb31-144">Teams will be installed to /Applications folder.</span></span> <span data-ttu-id="dfb31-145">它是计算机范围内的安装。</span><span class="sxs-lookup"><span data-stu-id="dfb31-145">It is a machine-wide installation.</span></span>

> [!NOTE]
> <span data-ttu-id="dfb31-146">安装期间，PKG 将提示输入管理员凭据。</span><span class="sxs-lookup"><span data-stu-id="dfb31-146">During the installation, the PKG will prompt for admin credentials.</span></span> <span data-ttu-id="dfb31-147">无论用户是否为管理员，都需要输入管理员凭据。</span><span class="sxs-lookup"><span data-stu-id="dfb31-147">The user needs to enter the admin credentials, regardless of whether or not the user is an admin.</span></span>

<span data-ttu-id="dfb31-148">如果用户当前有 Teams 的 DMG 安装，并且想要将其替换为 PKG 安装，则用户应：</span><span class="sxs-lookup"><span data-stu-id="dfb31-148">If a user currently has a DMG installation of Teams and wants to replace it with the PKG installation, the user should:</span></span>

1. <span data-ttu-id="dfb31-149">退出 Teams 应用。</span><span class="sxs-lookup"><span data-stu-id="dfb31-149">Exit the Teams app.</span></span>
2. <span data-ttu-id="dfb31-150">卸载 Teams 应用。</span><span class="sxs-lookup"><span data-stu-id="dfb31-150">Uninstall the Teams app.</span></span>
3. <span data-ttu-id="dfb31-151">安装 PKG 文件。</span><span class="sxs-lookup"><span data-stu-id="dfb31-151">Install the PKG file.</span></span>

<span data-ttu-id="dfb31-152">IT 管理员可以使用 Teams 的托管部署将安装文件分发到其组织中的所有 Mac，例如 Jamf Pro。</span><span class="sxs-lookup"><span data-stu-id="dfb31-152">IT admins can use managed deployment of Teams to distribute the installation files to all Macs in their organization, such as Jamf Pro.</span></span>

> [!NOTE]
> <span data-ttu-id="dfb31-153">如果安装 PKG 时遇到问题，请告诉我们。</span><span class="sxs-lookup"><span data-stu-id="dfb31-153">If you experience issues installing the PKG, let us know.</span></span> <span data-ttu-id="dfb31-154">在本文末尾的\*\*\*\*“反馈”部分中，单击“产品反馈”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="dfb31-154">In the **Feedback** section at the end of this article, click **Product feedback**.</span></span>

<a name="web-client"></a><span data-ttu-id="dfb31-155">Web 客户端</span><span class="sxs-lookup"><span data-stu-id="dfb31-155">Web client</span></span> 
----------

<span data-ttu-id="dfb31-156">Web 客户端 ([https://teams.microsoft.com](https://go.microsoft.com/fwlink/?linkid=855753)) 是具有完整功能的客户端，可以从各种浏览器使用该客户端。</span><span class="sxs-lookup"><span data-stu-id="dfb31-156">The web client (https://teams.microsoft.com) is a full, functional client that can be used from a variety of browsers.</span></span> <span data-ttu-id="dfb31-157">Web 客户端使用 webRTC 支持通话和会议，因此在 Web 浏览器中运行 Teams 不需要插件或进行下载。</span><span class="sxs-lookup"><span data-stu-id="dfb31-157">The web client supports Calling and Meetings by using webRTC, so there is no plug-in or download required to run Teams in a web browser.</span></span> <span data-ttu-id="dfb31-158">必须配置浏览器以允许第三方 Cookie。</span><span class="sxs-lookup"><span data-stu-id="dfb31-158">The browser must also be configured to allow 3rd-party cookies.</span></span> 

[!INCLUDE [browser-support](includes/browser-support.md)]

<span data-ttu-id="dfb31-159">Web 客户端在连接到 [https://teams.microsoft.com](https://go.microsoft.com/fwlink/?linkid=855753) 时执行浏览器版本检测。</span><span class="sxs-lookup"><span data-stu-id="dfb31-159">The web client performs browser version detection upon connecting to [https://teams.microsoft.com](https://go.microsoft.com/fwlink/?linkid=855753).</span></span> <span data-ttu-id="dfb31-160">如果检测到不支持的浏览器版本，它将阻止对 Web 界面的访问，并建议用户下载桌面客户端或移动应用。</span><span class="sxs-lookup"><span data-stu-id="dfb31-160">The Web client performs browser version detection upon connecting to https://teams.microsoft.com and if an unsupported browser version is detected, it will block access to the Web interface and recommend that the user download the desktop client or mobile app.</span></span>

<a name="mobile-clients"></a><span data-ttu-id="dfb31-161">移动客户端</span><span class="sxs-lookup"><span data-stu-id="dfb31-161">Mobile clients</span></span>
--------------

<span data-ttu-id="dfb31-162">Microsoft Teams 移动应用适用于 Android 和 iOS，适合参与基于聊天的对话的忙碌用户，允许进行点对点音频呼叫。</span><span class="sxs-lookup"><span data-stu-id="dfb31-162">The Microsoft Teams mobile apps are available for Android, iOS, and Windows Phones, and are geared for on-the-go users participating in chat-based conversations and allow peer-to-peer audio calls.</span></span> <span data-ttu-id="dfb31-163">对于移动应用，请访问 Google Play 和 Apple App Store 的相关移动应用商店。</span><span class="sxs-lookup"><span data-stu-id="dfb31-163">For mobile apps, go to the relevant mobile store for Google Play, Apple App Store, and Microsoft Store.</span></span> <span data-ttu-id="dfb31-164">Windows Phone 应用已于 2018 年 7 月 20 日停用，可能无法正常运行。</span><span class="sxs-lookup"><span data-stu-id="dfb31-164">The Windows Phone App was retired July 20, 2018 and may no longer work.</span></span> 

<span data-ttu-id="dfb31-165">Microsoft Teams 移动应用的支持移动平台如下：</span><span class="sxs-lookup"><span data-stu-id="dfb31-165">Supported mobile platforms for Microsoft Teams mobile apps are the following:</span></span>

-   <span data-ttu-id="dfb31-166">**Android**：4.4 或更高版本</span><span class="sxs-lookup"><span data-stu-id="dfb31-166">**Android**: 4.4 or later</span></span>

-   <span data-ttu-id="dfb31-167">**iOS**：10.0 或更高版本</span><span class="sxs-lookup"><span data-stu-id="dfb31-167">**iOS**: 10.0 or later</span></span>

> [!NOTE]
> <span data-ttu-id="dfb31-168">必须向公众提供移动版本，Teams 才能按预期工作。</span><span class="sxs-lookup"><span data-stu-id="dfb31-168">The mobile version must be available to the public in order for Teams to work as expected.</span></span>

<span data-ttu-id="dfb31-169">移动应用仅通过各自移动平台的应用商店进行分发和更新。</span><span class="sxs-lookup"><span data-stu-id="dfb31-169">Mobile apps are distributed and updated through the respective mobile platform’s app store only, and are not available to be distributed through MDM (mobile device management) solutions or side-loaded.</span></span> <span data-ttu-id="dfb31-170">Microsoft 不支持通过 MDM 或侧加载来分发移动应用。</span><span class="sxs-lookup"><span data-stu-id="dfb31-170">Distribution of the mobile apps via MDM or side-loading is not supported by Microsoft.</span></span> <span data-ttu-id="dfb31-171">在支持的移动平台上安装移动应用后，将支持 Teams 移动应用本身，前提是该版本是 3 个月内的最新版本。</span><span class="sxs-lookup"><span data-stu-id="dfb31-171">Once the mobile app has been installed on a supported mobile platform, the Teams Mobile App itself will be supported provided the version is within three months of the current release.</span></span>


| | | |
|---------|---------|---------|
|![描述决策点的图标](media/Get_clients_for_Microsoft_Teams_image4.png)      |<span data-ttu-id="dfb31-173">决策点</span><span class="sxs-lookup"><span data-stu-id="dfb31-173">Decision Point</span></span>         |<span data-ttu-id="dfb31-174">是否存在阻止用户在其设备上安装合适 Microsoft Teams 客户端的任何限制？</span><span class="sxs-lookup"><span data-stu-id="dfb31-174">Are there any restrictions preventing users from installing the appropriate Microsoft Teams client on their devices?</span></span>         |
|![描述后续步骤的图标](media/Get_clients_for_Microsoft_Teams_image5.png)     |<span data-ttu-id="dfb31-176">后续步骤</span><span class="sxs-lookup"><span data-stu-id="dfb31-176">Next Steps</span></span>         |<span data-ttu-id="dfb31-177">如果贵组织限制软件安装，请确保 Microsoft Teams 不会受到阻止。</span><span class="sxs-lookup"><span data-stu-id="dfb31-177">If your organization restricts software installation, make sure that process is compatible with Microsoft Teams.</span></span> <span data-ttu-id="dfb31-178">注意：PC 客户端安装不需要管理权限，但在 Mac 上安装需要。</span><span class="sxs-lookup"><span data-stu-id="dfb31-178">Note: Admin rights are not required for PC client installation but are required for installation on a Mac.</span></span>         |

<a name="client-update-management"></a><span data-ttu-id="dfb31-179">客户端更新管理</span><span class="sxs-lookup"><span data-stu-id="dfb31-179">Client update management</span></span>
------------------------

<span data-ttu-id="dfb31-180">当前，Microsoft Teams 服务会自动更新客户端，无需 IT 管理员干预。</span><span class="sxs-lookup"><span data-stu-id="dfb31-180">Clients are currently updated automatically by the Microsoft Teams service with no IT administrator intervention required.</span></span> <span data-ttu-id="dfb31-181">如果有更新，客户端将自动下载更新，当应用空闲一段时间后，将开始执行更新过程。</span><span class="sxs-lookup"><span data-stu-id="dfb31-181">If an update is available, the client will automatically download the update and when the app has idled for a period of time, the update process will kick off.</span></span>

<a name="client-side-configurations"></a><span data-ttu-id="dfb31-182">客户端配置</span><span class="sxs-lookup"><span data-stu-id="dfb31-182">Client-side configurations</span></span>
---------------------------

<span data-ttu-id="dfb31-183">当前，未提供支持的选项来通过租户管理、PowerShell、组策略对象或注册表配置客户端。</span><span class="sxs-lookup"><span data-stu-id="dfb31-183">Currently, there are no supported options available to configure the client either through the tenant admin, PowerShell, Group Policy Objects or the registry.</span></span>

<a name="notification-settings"></a><span data-ttu-id="dfb31-184">通知设置</span><span class="sxs-lookup"><span data-stu-id="dfb31-184">Notification settings</span></span>
----------------------------

<span data-ttu-id="dfb31-185">当前，未提供选项允许 IT 管理员配置客户端通知设置。</span><span class="sxs-lookup"><span data-stu-id="dfb31-185">There are currently no options available for IT administrators to configure client-side notification settings.</span></span> <span data-ttu-id="dfb31-186">所有通知选项均由用户设置。</span><span class="sxs-lookup"><span data-stu-id="dfb31-186">All notification options are set by the user.</span></span> <span data-ttu-id="dfb31-187">下图概括显示了默认客户端设置。</span><span class="sxs-lookup"><span data-stu-id="dfb31-187">The figure below outlines the default client settings.</span></span>

![“通知设置”屏幕截图。](media/Get_clients_for_Microsoft_Teams_image6.png)

<a name="sample-powershell-script"></a><span data-ttu-id="dfb31-189">示例 PowerShell 脚本</span><span class="sxs-lookup"><span data-stu-id="dfb31-189">Sample PowerShell Script</span></span>
----------------------------

<span data-ttu-id="dfb31-190">需要在提升的管理员帐户上下文中的客户端计算机上运行的此示例脚本将为 c:\users 中找到的每个用户文件夹创建新的入站防火墙规则。</span><span class="sxs-lookup"><span data-stu-id="dfb31-190">This sample script, which needs to run on client computers in the context of an elevated administrator account, will create a new inbound firewall rule for each user folder found in c:\users.</span></span> <span data-ttu-id="dfb31-191">Teams 找到此规则后，当用户通过 Teams 进行首次呼叫时，将阻止 Teams 应用程序提示用户创建防火墙规则。</span><span class="sxs-lookup"><span data-stu-id="dfb31-191">When Teams finds this rule, it will prevent the Teams application from prompting users to create firewall rules when the users make their first call from Teams.</span></span> 

```

<#
.Synopsis
   Creates firewall rules for Teams.
.DESCRIPTION
   (c) Microsoft Corporation 2018. All rights reserved. Script provided as-is without any warranty of any kind. Use it freely at your own risks.
   Must be run with elevated permissions. Can be run as a GPO Computer Startup script, or as a Scheduled Task with elevated permissions. 
   The script will create a new inbound firewall rule for each user folder found in c:\users. 
   Requires PowerShell 3.0.
#>

#Requires -Version 3

$users = Get-ChildItem (Join-Path -Path $env:SystemDrive -ChildPath 'Users') -Exclude 'Public', 'ADMINI~*'
if ($users.Length -gt 0)
{
    foreach ($user in $users)
    {
        $progPath = Join-Path -Path $user.FullName -ChildPath "AppData\Local\Microsoft\Teams\Current\Teams.exe"
        if (Test-Path $progPath)
        {
            if (-not (Get-NetFirewallApplicationFilter -Program $progPath -ErrorAction SilentlyContinue))
            {
                $ruleName = "Teams.exe for user $($user.Name)"
                "UDP", "TCP" | ForEach-Object { New-NetFirewallRule -DisplayName $ruleName -Direction Inbound -Profile Domain -Program $progPath -Action Allow -Protocol $_ }
                Clear-Variable ruleName
            }
        }
        Clear-Variable progPath
    }
}

```
