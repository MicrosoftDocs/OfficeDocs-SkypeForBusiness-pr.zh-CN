---
title: 使用 Microsoft 团队安装 Moodle 集成
author: MicrosoftHeidi
ms.author: heidip
manager: serdars
ms.date: 05/01/2019
ms.topic: article
ms.service: msteams
ms.reviewer: ''
search.appverid: MET150
description: 了解如何安装和配置 Microsoft 团队 Moodle 集成应用程序。
keywords: 团队 Moodle 应用程序集成插件
localization_priority: Normal
MS.collection: Teams_ITAdmin_Help
appliesto: Microsoft Teams
ms.openlocfilehash: 92259a9ef01232aaeca67089b5d654fe302f1224
ms.sourcegitcommit: 9a99be1365df439f9443f31240aa5311782458df
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/14/2019
ms.locfileid: "34055359"
---
# <a name="install-moodle-integration-with-microsoft-teams"></a><span data-ttu-id="c0487-104">使用 Microsoft 团队安装 Moodle 集成</span><span class="sxs-lookup"><span data-stu-id="c0487-104">Install Moodle integration with Microsoft Teams</span></span>

> [!VIDEO https://www.youtube.com/embed/OHlPt22nKoE]

<span data-ttu-id="c0487-105">与 Microsoft 团队现在集成[Moodle](https://moodle.org/)，最受欢迎且打开源学习管理系统 (LMS) 在世界 ！</span><span class="sxs-lookup"><span data-stu-id="c0487-105">[Moodle](https://moodle.org/), the most popular and open source Learning Management System (LMS) in the world, is now integrated with Microsoft Teams!</span></span> <span data-ttu-id="c0487-106">此集成有助于教师和教师周围 Moodle 课程协作、 提问有关其薪等级和分配，并保持与通知-团队中的所有更新 ！</span><span class="sxs-lookup"><span data-stu-id="c0487-106">This integration helps educators and teachers collaborate around Moodle courses, ask questions about their grades and assignments, and stay updated with notifications -- all within Teams!</span></span>

<span data-ttu-id="c0487-107">为了方便地建立这种集成的 IT 管理员，我们已更新 Office 365 Moodle 插件我们打开源具有以下功能：</span><span class="sxs-lookup"><span data-stu-id="c0487-107">To help IT admins easily set up this integration, we have updated our open source Office 365 Moodle plugin with the following capabilities:</span></span>

- <span data-ttu-id="c0487-108">自动注册 Moodle 服务器与 Azure AD 的</span><span class="sxs-lookup"><span data-stu-id="c0487-108">Auto-registration of your Moodle server with Azure AD</span></span>
- <span data-ttu-id="c0487-109">一次单击部署到 Azure 您 Moodle 助理自动程序的</span><span class="sxs-lookup"><span data-stu-id="c0487-109">One-click deployment of your Moodle Assistant bot to Azure</span></span>
- <span data-ttu-id="c0487-110">自动设置的团队和自动同步所有的团队注册或选择 Moodle 课程</span><span class="sxs-lookup"><span data-stu-id="c0487-110">Auto-provisioning of teams and auto-synchronization of team enrollments for all or select Moodle courses</span></span>
- <span data-ttu-id="c0487-111">自动安装 Moodle 选项卡和 Moodle 助手 bot 到每个同步工作组 （即将推出）</span><span class="sxs-lookup"><span data-stu-id="c0487-111">Auto-installation of the Moodle tab and the Moodle Assistant bot into each synchronized team (coming soon)</span></span>
- <span data-ttu-id="c0487-112">Moodle 应用程序 （即将推出） 私有团队应用程序存储到的一键式发布</span><span class="sxs-lookup"><span data-stu-id="c0487-112">One-click publishing of the Moodle app into your private Teams App Store (coming soon)</span></span>

## <a name="prerequisites"></a><span data-ttu-id="c0487-113">先决条件</span><span class="sxs-lookup"><span data-stu-id="c0487-113">Prerequisites</span></span>

<span data-ttu-id="c0487-114">安装和配置此应用程序，您将需要：</span><span class="sxs-lookup"><span data-stu-id="c0487-114">To install and configure this application you'll need:</span></span>

- <span data-ttu-id="c0487-115">Moodle 管理员凭据</span><span class="sxs-lookup"><span data-stu-id="c0487-115">Moodle administrator credentials</span></span>
- <span data-ttu-id="c0487-116">Azure AD 管理员凭据</span><span class="sxs-lookup"><span data-stu-id="c0487-116">Azure AD administrator credentials</span></span>
- <span data-ttu-id="c0487-117">您可以创建新资源中的 Azure 订阅</span><span class="sxs-lookup"><span data-stu-id="c0487-117">An Azure subscription that you can create new resources in</span></span>

## <a name="step-1-install-the-office-365-moodle-plugin"></a><span data-ttu-id="c0487-118">步骤 1： 安装 Office 365 Moodle 插件</span><span class="sxs-lookup"><span data-stu-id="c0487-118">Step 1: Install the Office 365 Moodle plugin</span></span>

> [!VIDEO https://www.youtube.com/embed/SETEC5nzMgk]

<span data-ttu-id="c0487-119">中的 Microsoft 团队 Moodle 集成是由开源[Office 365 Moodle 插件](https://github.com/Microsoft/o365-moodle)供电。</span><span class="sxs-lookup"><span data-stu-id="c0487-119">The Moodle integration in Microsoft Teams is powered by the open source [Office 365 Moodle plugin](https://github.com/Microsoft/o365-moodle).</span></span> <span data-ttu-id="c0487-120">Moodle 服务器上安装该插件：</span><span class="sxs-lookup"><span data-stu-id="c0487-120">To install the plugin on your Moodle server:</span></span>

1. <span data-ttu-id="c0487-121">下载[Office 365 插件设置](https://moodle.org/plugins/pluginversions.php?plugin=local_o365)并将其保存在本地计算机上。</span><span class="sxs-lookup"><span data-stu-id="c0487-121">Download the [Office 365 plugin set](https://moodle.org/plugins/pluginversions.php?plugin=local_o365) and save it on your local computer.</span></span> <span data-ttu-id="c0487-122">您需要使用 3.5 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="c0487-122">You'll need to use version 3.5 or newer.</span></span>
2. <span data-ttu-id="c0487-123">登录到 Moodle 服务器作为管理员，并从左侧的导航窗格中选择**网站管理**。</span><span class="sxs-lookup"><span data-stu-id="c0487-123">Sign in to your Moodle server as an administrator, and select **Site administration** from the left navigation pane.</span></span>
3. <span data-ttu-id="c0487-124">选择**插件**选项卡，然后单击**安装插件**。</span><span class="sxs-lookup"><span data-stu-id="c0487-124">Select the **Plugins** tab, and then click **Install plugins**.</span></span>
4. <span data-ttu-id="c0487-125">在**安装插件 ZIP 文件中的**部分单击**选择文件**按钮。</span><span class="sxs-lookup"><span data-stu-id="c0487-125">Under the **Install plugin from ZIP file** section click the **Choose a file** button.</span></span>
5. <span data-ttu-id="c0487-126">左侧的导航窗格中，选择**上载文件**选项，浏览到上方，下载的文件，然后单击**将此文件上载**。</span><span class="sxs-lookup"><span data-stu-id="c0487-126">Select the **Upload a file** options from the left navigation pane, browse to the file you downloaded above, and click **Upload this file**.</span></span>
6. <span data-ttu-id="c0487-127">在左侧的导航窗格中，再次以返回到您的管理员仪表板中选择**网站管理**选项。</span><span class="sxs-lookup"><span data-stu-id="c0487-127">Select the **Site administration** option from the left navigation pane again to return to your admin dashboard.</span></span> <span data-ttu-id="c0487-128">向下**本地插件**滚动并单击**Microsoft Office 365 集成**链接。</span><span class="sxs-lookup"><span data-stu-id="c0487-128">Scroll down to the **Local plugins** and click the **Microsoft Office 365 Integration** link.</span></span> <span data-ttu-id="c0487-129">保留此配置页上的一个单独的浏览器选项卡中打开： 您将使用其此过程的其余。</span><span class="sxs-lookup"><span data-stu-id="c0487-129">Keep this configuration page open in a separate browser tab: you'll be using it throughout the rest of this process.</span></span>

<span data-ttu-id="c0487-130">您可以找到有关如何安装 Moodle 插件[Moodle 文档](https://docs.moodle.org/34/en/Installing_plugins)中的详细信息。</span><span class="sxs-lookup"><span data-stu-id="c0487-130">You can find more information on how to install Moodle plugins in the [Moodle documentation](https://docs.moodle.org/34/en/Installing_plugins).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="c0487-131">保留您的 Office 365 Moodle 插件配置页上的一个单独的浏览器选项卡中打开： 您将返回到此组在此过程中的所有页面。</span><span class="sxs-lookup"><span data-stu-id="c0487-131">Keep your Office 365 Moodle plugin configuration page open in a separate browser tab: you'll be returning to this set of pages throughout this process.</span></span>

<span data-ttu-id="c0487-132">不会已经 Moodle 网站？</span><span class="sxs-lookup"><span data-stu-id="c0487-132">Don't have a Moodle site already?</span></span> <span data-ttu-id="c0487-133">您可能想要签出我们 Moodle 上 Azure [repo](https://github.com/azure/moodle)您可以快速部署 Azure 上的 Moodle 实例和其自定义您的需要。</span><span class="sxs-lookup"><span data-stu-id="c0487-133">You might want to check out our Moodle on Azure [repo](https://github.com/azure/moodle) where you can quickly deploy a Moodle instance on Azure and customize it to your needs.</span></span>

## <a name="step-2-configure-the-connection-between-the-office-365-plugin-and-azure-active-directory"></a><span data-ttu-id="c0487-134">步骤 2： 配置 Office 365 插件和 Azure Active Directory 之间的连接</span><span class="sxs-lookup"><span data-stu-id="c0487-134">Step 2: Configure the connection between the Office 365 plugin and Azure Active Directory</span></span>

> [!VIDEO https://www.youtube.com/embed/FpGEezaJ3SA]

<span data-ttu-id="c0487-135">接下来，您将需要注册 Moodle 为 Azure Active Directory (Azure AD) 中的应用程序。</span><span class="sxs-lookup"><span data-stu-id="c0487-135">Next you'll need to register Moodle as an application in your Azure Active Directory (Azure AD).</span></span> <span data-ttu-id="c0487-136">我们提供了可帮助您完成此过程的 PowerShell 脚本。</span><span class="sxs-lookup"><span data-stu-id="c0487-136">We've provided a PowerShell script to help you complete this process.</span></span> <span data-ttu-id="c0487-137">PowerShell 脚本设置新的 Azure AD 应用程序的 Office 365 租户，将使用 Office 365 Moodle 插件。</span><span class="sxs-lookup"><span data-stu-id="c0487-137">The PowerShell script provisions a new Azure AD application for your Office 365 tenant, which will be used by the Office 365 Moodle plugin.</span></span> <span data-ttu-id="c0487-138">此脚本将设置 O365 租户的应用程序、 设置所有必需回复 Url 和权限设置的应用程序，并返回 AppID 和密钥。</span><span class="sxs-lookup"><span data-stu-id="c0487-138">The script will provision the app for your O365 tenant, set up all the required Reply URLs and permissions for the provisioned app, and return the AppID and Key.</span></span> <span data-ttu-id="c0487-139">您可以使用生成的 AppID 和键在 O365 Moodle 插件安装程序页面中配置与 Azure AD Moodle 服务器。</span><span class="sxs-lookup"><span data-stu-id="c0487-139">You can use the generated AppID and Key in your O365 Moodle plugin setup page to configure your Moodle server with Azure AD.</span></span> <span data-ttu-id="c0487-140">如果您希望看到自动 PowerShell 脚本的详细手动步骤，您可以找到这些完整[插件的文档](https://docs.moodle.org/34/en/Office365#Register_your_Moodle_instance_as_an_Application)中。</span><span class="sxs-lookup"><span data-stu-id="c0487-140">If you want to see the detailed manual steps that the PowerShell script is automating, you can find them in the full [documentation for the plugin](https://docs.moodle.org/34/en/Office365#Register_your_Moodle_instance_as_an_Application).</span></span>

1. <span data-ttu-id="c0487-141">在 Microsoft Office 365 集成插件页上，选择**安装**选项卡。</span><span class="sxs-lookup"><span data-stu-id="c0487-141">On the Microsoft Office 365 Integration plugin page, select the **Setup** tab.</span></span>
2. <span data-ttu-id="c0487-142">单击**下载 PowerShell 脚本**按钮，并将脚本保存在本地计算机上。</span><span class="sxs-lookup"><span data-stu-id="c0487-142">Click the **Download PowerShell Script** button, and save the script on your local computer.</span></span>
3. <span data-ttu-id="c0487-143">您需要准备 ZIP 文件中的 PowerShell 脚本。</span><span class="sxs-lookup"><span data-stu-id="c0487-143">You'll need to prepare the PowerShell script from the ZIP file.</span></span> <span data-ttu-id="c0487-144">若要此操作：</span><span class="sxs-lookup"><span data-stu-id="c0487-144">To do this:</span></span>
    1. <span data-ttu-id="c0487-145">下载并解压缩 Moodle-AzureAD Powershell.zip 文件。</span><span class="sxs-lookup"><span data-stu-id="c0487-145">Download and extract the Moodle-AzureAD-Powershell.zip file.</span></span>
    2. <span data-ttu-id="c0487-146">打开解压缩的文件夹。</span><span class="sxs-lookup"><span data-stu-id="c0487-146">Open the extracted folder.</span></span>
    3. <span data-ttu-id="c0487-147">右键单击 Moodle-AzureAD Script.ps1 文件，然后选择**属性**。</span><span class="sxs-lookup"><span data-stu-id="c0487-147">Right-click the Moodle-AzureAD-Script.ps1 file, and select **Properties**.</span></span>
    4. <span data-ttu-id="c0487-148">在属性窗口的**常规**选项卡上，选中在底部的**安全**属性旁边的**取消阻止**框。</span><span class="sxs-lookup"><span data-stu-id="c0487-148">On the **General** tab of the Properties window, check the **Unblock** box next to the **Security** attribute at the bottom.</span></span>
    5. <span data-ttu-id="c0487-149">单击“**确定**”。</span><span class="sxs-lookup"><span data-stu-id="c0487-149">Click **OK**.</span></span>
    6. <span data-ttu-id="c0487-150">将复制解压缩的文件夹的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="c0487-150">Copy the directory path of the extracted folder.</span></span>
4. <span data-ttu-id="c0487-151">接下来，您将以管理员身份运行 PowerShell:</span><span class="sxs-lookup"><span data-stu-id="c0487-151">Next you'll run PowerShell as an administrator:</span></span>
    1. <span data-ttu-id="c0487-152">单击“开始”。</span><span class="sxs-lookup"><span data-stu-id="c0487-152">Click Start.</span></span>
    2. <span data-ttu-id="c0487-153">类型**PowerShell**。</span><span class="sxs-lookup"><span data-stu-id="c0487-153">Type **PowerShell**.</span></span>
    3. <span data-ttu-id="c0487-154">右键单击**Windows PowerShell**。</span><span class="sxs-lookup"><span data-stu-id="c0487-154">Right-click **Windows PowerShell**.</span></span>
    4. <span data-ttu-id="c0487-155">单击**以管理员身份运行**。</span><span class="sxs-lookup"><span data-stu-id="c0487-155">Click **Run as Administrator**.</span></span>
5. <span data-ttu-id="c0487-156">键入以下命令以导航到解压缩目录`cd ...\...\Moodle-AzureAD-Powershell`其中`...\...`是目录的路径。</span><span class="sxs-lookup"><span data-stu-id="c0487-156">Navigate to the unzipped directory by typing `cd ...\...\Moodle-AzureAD-Powershell` where `...\...` is the path to the directory.</span></span>
6. <span data-ttu-id="c0487-157">执行 PowerShell 脚本：</span><span class="sxs-lookup"><span data-stu-id="c0487-157">Execute the PowerShell script:</span></span>
    1. <span data-ttu-id="c0487-158">输入`Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`。</span><span class="sxs-lookup"><span data-stu-id="c0487-158">Enter `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`.</span></span>
    2. <span data-ttu-id="c0487-159">输入`.\Moodle-AzureAD-Script.ps1`。</span><span class="sxs-lookup"><span data-stu-id="c0487-159">Enter `.\Moodle-AzureAD-Script.ps1`.</span></span>
    3. <span data-ttu-id="c0487-160">登录到您在弹出窗口的 O365 管理员帐户。</span><span class="sxs-lookup"><span data-stu-id="c0487-160">Sign in to your O365 administrator account in the pop-up window.</span></span>
    4. <span data-ttu-id="c0487-161">输入 Azure AD 应用程序 （例如， **Moodle/Moodle 插件**） 的名称。</span><span class="sxs-lookup"><span data-stu-id="c0487-161">Enter the name of the Azure AD application (for example, **Moodle/Moodle plugin**).</span></span>
    5. <span data-ttu-id="c0487-162">输入 Moodle 服务器的 URL。</span><span class="sxs-lookup"><span data-stu-id="c0487-162">Enter the URL of your Moodle server.</span></span>
    6. <span data-ttu-id="c0487-163">复制的**应用程序 ID**和**应用程序键**生成脚本，并将其保存。</span><span class="sxs-lookup"><span data-stu-id="c0487-163">Copy the **Application ID** and **Application Key** generated by the script, and save them.</span></span>
7. <span data-ttu-id="c0487-164">接下来，您需要将 ID 和密钥添加到 Office 365 Moodle 插件。</span><span class="sxs-lookup"><span data-stu-id="c0487-164">Next you'll need to add the ID and key to the Office 365 Moodle plugin.</span></span> <span data-ttu-id="c0487-165">返回到插件管理页 (**网站管理** > **插件** > **Microsoft Office 365 集成**)。</span><span class="sxs-lookup"><span data-stu-id="c0487-165">Return to the plugin administration page (**Site administration** > **Plugins** > **Microsoft Office 365 Integration**).</span></span>
8. <span data-ttu-id="c0487-166">在**安装**选项卡中，添加**应用程序 ID**和**应用程序密钥**之前，复制，然后单击**保存所做更改**。</span><span class="sxs-lookup"><span data-stu-id="c0487-166">On the **Setup** tab, add the **Application ID** and **Application Key** you copied previously, and then click **Save changes**.</span></span>
9. <span data-ttu-id="c0487-167">一次页面将刷新，您应看到调用**选择连接方法**的新部分。</span><span class="sxs-lookup"><span data-stu-id="c0487-167">Once the page refreshes, you should see a new section called **Choose connection method**.</span></span> <span data-ttu-id="c0487-168">单击标记为**默认值**的复选框，然后单击**保存所做更改**。</span><span class="sxs-lookup"><span data-stu-id="c0487-168">Click the check box labeled **Default**, and then click **Save changes**.</span></span>
10. <span data-ttu-id="c0487-169">一次页面将刷新，您将看到新的部分调用**管理 consent & 其他信息**。</span><span class="sxs-lookup"><span data-stu-id="c0487-169">Once the page refreshes, you'll see a new section called **Admin consent & additional information**.</span></span>
    1. <span data-ttu-id="c0487-170">单击**提供管理 Consent**链接，输入 Office3 365 全局管理员凭据，，然后单击**接受**授予权限。</span><span class="sxs-lookup"><span data-stu-id="c0487-170">Click the **Provide Admin Consent** link, enter your Office3 365 Global Administrator credentials, and then click **Accept** to grant the permissions.</span></span>
    2. <span data-ttu-id="c0487-171">**Azure AD 租户**字段旁边，单击**检测**按钮。</span><span class="sxs-lookup"><span data-stu-id="c0487-171">Next to the **Azure AD Tenant** field, click the **Detect** button.</span></span>
    3. <span data-ttu-id="c0487-172">**OneDrive for Business URL**旁边单击**检测**按钮。</span><span class="sxs-lookup"><span data-stu-id="c0487-172">Next to **OneDrive for Business URL**, click the **Detect** button.</span></span>
    4. <span data-ttu-id="c0487-173">一旦填充字段，单击**保存更改**按钮。</span><span class="sxs-lookup"><span data-stu-id="c0487-173">Once the fields populate, click the **Save changes** button.</span></span>
11. <span data-ttu-id="c0487-174">单击**更新**按钮，以确认安装，然后单击**保存所做更改**。</span><span class="sxs-lookup"><span data-stu-id="c0487-174">Click the **Update** button to verify the installation, and then click **Save changes**.</span></span>
12. <span data-ttu-id="c0487-175">接下来，您将需要同步 Moodle 服务器和 Azure AD 之间的用户。</span><span class="sxs-lookup"><span data-stu-id="c0487-175">Next you'll need to synchronize users between your Moodle server and Azure AD.</span></span> <span data-ttu-id="c0487-176">根据您的环境，您可以在此阶段选择不同的选项。</span><span class="sxs-lookup"><span data-stu-id="c0487-176">Depending on your environment, you may select different options during this stage.</span></span> <span data-ttu-id="c0487-177">请注意，此处设置的配置将与 （通常每天运行一次） 以使任何内容同步每个 Moodle cron 一起运行。若要开始：</span><span class="sxs-lookup"><span data-stu-id="c0487-177">Note that the configuration you set here will run with each Moodle cron run (typically once a day) to keep everything in sync. To get started:</span></span>
    1. <span data-ttu-id="c0487-178">切换到**Sync 设置选项卡**。</span><span class="sxs-lookup"><span data-stu-id="c0487-178">Switch to the **Sync Settings tab**.</span></span>
    2. <span data-ttu-id="c0487-179">在**同步与 Azure AD 的用户**部分中，选择适用于您的环境对应的复选框。</span><span class="sxs-lookup"><span data-stu-id="c0487-179">In the **Sync users with Azure AD** section, select the check boxes that apply to your environment.</span></span> <span data-ttu-id="c0487-180">通常，应选择至少：</span><span class="sxs-lookup"><span data-stu-id="c0487-180">Typically you would select at least:</span></span>
        - <span data-ttu-id="c0487-181">**在 Azure AD 帐户在 Moodle 中创建的用户**</span><span class="sxs-lookup"><span data-stu-id="c0487-181">**Create accounts in Moodle for users in Azure AD**</span></span>
        - <span data-ttu-id="c0487-182">**Azure AD 中更新 Moodle 中的用户的所有帐户**</span><span class="sxs-lookup"><span data-stu-id="c0487-182">**Update all accounts in Moodle for users in Azure AD**</span></span>
    3. <span data-ttu-id="c0487-183">在**用户创建限制**部分中，您可以设置筛选器以限制将同步到 Moodle 的 Azure AD 用户。</span><span class="sxs-lookup"><span data-stu-id="c0487-183">In the **User Creation Restriction** section, you can set up a filter to limit the Azure AD users that will be synced to Moodle.</span></span>
    4. <span data-ttu-id="c0487-184">**用户域映射**部分将允许您自定义 Moodle 用户配置文件字段映射到 Azure AD。</span><span class="sxs-lookup"><span data-stu-id="c0487-184">The **User Field Mapping** section will allow you to customize the Azure AD to Moodle User Profile field mapping.</span></span>
    5. <span data-ttu-id="c0487-185">在**团队同步**部分您可以选择自动创建组 （即，团队） 为部分或全部您现有的 Moodle 课程。</span><span class="sxs-lookup"><span data-stu-id="c0487-185">In the **Teams Sync** section you can choose to automatically create groups (that is, teams) for some or all of your existing Moodle courses.</span></span>
13. <span data-ttu-id="c0487-186">若要验证 cron 作业 （并手动运行它们，如果想要对第一个域），请单击**同步与 Azure AD 的用户**部分中的**计划任务管理页**链接。</span><span class="sxs-lookup"><span data-stu-id="c0487-186">To validate the cron jobs (and run them manually if you wish to for the first run), click the **Scheduled tasks management page** link in the **Sync users with Azure AD** section.</span></span> <span data-ttu-id="c0487-187">这会将您导引到**任务计划**页。</span><span class="sxs-lookup"><span data-stu-id="c0487-187">This will take you to the **Scheduled Tasks** page.</span></span>
    1. <span data-ttu-id="c0487-188">向下滚动和查找作业**同步用户与 Azure AD**作业，然后单击**立即运行**。</span><span class="sxs-lookup"><span data-stu-id="c0487-188">Scroll down and find the job **Sync users with Azure AD** job, and click **Run now**.</span></span>
    2. <span data-ttu-id="c0487-189">如果您选择创建基于现有的课程的组，您还可以运行**Office 365 中的创建用户组**作业。</span><span class="sxs-lookup"><span data-stu-id="c0487-189">If you chose to create groups based on existing courses, you can also run the **Create user groups in Office 365** job.</span></span>
14. <span data-ttu-id="c0487-190">返回到插件管理页 (**网站管理** > **插件** > **Microsoft Office 365 集成**)，然后选择**工作组设置**页。</span><span class="sxs-lookup"><span data-stu-id="c0487-190">Return to the plugin administration page (**Site administration** > **Plugins** > **Microsoft Office 365 Integration**) and select the **Teams Settings** page.</span></span> <span data-ttu-id="c0487-191">您需要配置某些安全设置，以启用团队应用程序集成。</span><span class="sxs-lookup"><span data-stu-id="c0487-191">You'll need to configure some security settings to enable the Teams app integration.</span></span>
    1. <span data-ttu-id="c0487-192">要启用 OpenID 连接，请单击**管理身份验证**链接，然后单击**OpenId 连接**行上的眼睛图标，如果它变暗。</span><span class="sxs-lookup"><span data-stu-id="c0487-192">To enable OpenID Connect, click the **Manage Authentication** link, and click the eye icon on the **OpenId Connect** line if it is dimmed.</span></span>
    2. <span data-ttu-id="c0487-193">若要启用嵌入的框架，单击**HTTP 安全**链接，然后选择**允许框架嵌入**旁边的复选框。</span><span class="sxs-lookup"><span data-stu-id="c0487-193">To enable frame embedding, click the **HTTP Security** link, and then select the check box next to **Allow frame embedding**.</span></span>
    3. <span data-ttu-id="c0487-194">启用 web 服务 （这将启用 Moodle API 功能）。</span><span class="sxs-lookup"><span data-stu-id="c0487-194">Enable web services (which will enable the Moodle API features).</span></span> <span data-ttu-id="c0487-195">单击**高级功能**链接，并确保选择**启用 web 服务**旁边的复选框。</span><span class="sxs-lookup"><span data-stu-id="c0487-195">Click the **Advanced Features** link, and then make sure the check box next to **Enable web services** is selected.</span></span>
    4. <span data-ttu-id="c0487-196">启用外部 Office 365 服务。</span><span class="sxs-lookup"><span data-stu-id="c0487-196">Enable the external services for Office 365.</span></span> <span data-ttu-id="c0487-197">单击**外部服务**链接，然后：</span><span class="sxs-lookup"><span data-stu-id="c0487-197">Click the **External services** link, and then:</span></span>
        1. <span data-ttu-id="c0487-198">在**Moodle Office 365 Webservices**行上，单击**编辑**。</span><span class="sxs-lookup"><span data-stu-id="c0487-198">Click **Edit** on the **Moodle Office 365 Webservices** row.</span></span>
        2. <span data-ttu-id="c0487-199">选择**启用**，旁边的复选框，然后单击**保存更改**</span><span class="sxs-lookup"><span data-stu-id="c0487-199">Select the check box next to **Enabled**, and then click **Save Changes**</span></span>
    5. <span data-ttu-id="c0487-200">最后，您需要编辑您允许用户创建 web 服务令牌的身份验证的用户权限。</span><span class="sxs-lookup"><span data-stu-id="c0487-200">Finally, you need to edit your authenticated user permissions to allow users to create web service tokens.</span></span> <span data-ttu-id="c0487-201">单击**编辑角色经过身份验证用户**链接。</span><span class="sxs-lookup"><span data-stu-id="c0487-201">Click the **Editing role Authenticated user** link.</span></span> <span data-ttu-id="c0487-202">向下滚动和找到的**创建 web 服务令牌**功能，然后选择**允许**复选框。</span><span class="sxs-lookup"><span data-stu-id="c0487-202">Scroll down and find the **Create a web service token** capability, and select the **Allow** check box.</span></span>

## <a name="step-3-deploy-the-moodle-assistant-bot-to-azure"></a><span data-ttu-id="c0487-203">步骤 3： 部署到 Azure Moodle 助理自动程序</span><span class="sxs-lookup"><span data-stu-id="c0487-203">Step 3: Deploy the Moodle Assistant Bot to Azure</span></span>

> [!VIDEO https://www.youtube.com/embed/gbkJxf8FlfY]

<span data-ttu-id="c0487-204">教师和学生回答问题有关其课程、 工作分配、 薪等级和 Moodle 中的其他信息，可帮助 Microsoft 团队免费 Moodle 助手 Bot。</span><span class="sxs-lookup"><span data-stu-id="c0487-204">The free Moodle Assistant Bot for Microsoft Teams helps teachers and students answer questions about their courses, assignments, grades, and other information in Moodle.</span></span> <span data-ttu-id="c0487-205">Bot 还 Moodle 将通知发送到学生和教师团队中右。</span><span class="sxs-lookup"><span data-stu-id="c0487-205">The bot also sends Moodle notifications to students and teachers right within Teams.</span></span> <span data-ttu-id="c0487-206">此自动程序是由 Microsoft 维护的开放源代码项目，并且[GitHub 上可用](https://github.com/microsoft/Moodle-Teams-Bot)。</span><span class="sxs-lookup"><span data-stu-id="c0487-206">This bot is an open source project maintained by Microsoft and is [available on GitHub](https://github.com/microsoft/Moodle-Teams-Bot).</span></span>

> [!NOTE]
<span data-ttu-id="c0487-207">.</span><span class="sxs-lookup"><span data-stu-id="c0487-207"></span></span> <span data-ttu-id="c0487-208">在此部分中，您将部署资源 Azure 订阅，并将使用的免费层配置的所有资源。</span><span class="sxs-lookup"><span data-stu-id="c0487-208">In this section you will deploy resources to your Azure subscription, and all resources will be configured using the free tier.</span></span> <span data-ttu-id="c0487-209">根据您自动程序的使用情况，您可能需要扩展这些资源。</span><span class="sxs-lookup"><span data-stu-id="c0487-209">Depending on the usage of your bot, you may need to scale these resources.</span></span> <span data-ttu-id="c0487-210">如果您想要仅使用不自动程序的情况下的 Moodle 选项卡，则跳到[步骤 4](#step-4-deploy-your-microsoft-teams-app)。</span><span class="sxs-lookup"><span data-stu-id="c0487-210">If you want to just use the Moodle tab without the bot, skip to [step 4](#step-4-deploy-your-microsoft-teams-app).</span></span>

### <a name="moodle-bot-information-flow"></a><span data-ttu-id="c0487-211">Moodle bot 信息流</span><span class="sxs-lookup"><span data-stu-id="c0487-211">Moodle bot information flow</span></span>

<span data-ttu-id="c0487-212">若要安装自动程序，您将需要在[Microsoft Identity 平台](https://identity.microsoft.com/Landing)上注册它。</span><span class="sxs-lookup"><span data-stu-id="c0487-212">To install the bot, you'll need to register it on the [Microsoft Identity Platform](https://identity.microsoft.com/Landing).</span></span> <span data-ttu-id="c0487-213">这样，您自动程序进行身份验证与您的 Microsoft 终结点。</span><span class="sxs-lookup"><span data-stu-id="c0487-213">This allows your bot to authenticate with your Microsoft endpoints.</span></span> <span data-ttu-id="c0487-214">若要注册您自动程序：</span><span class="sxs-lookup"><span data-stu-id="c0487-214">To register your bot:</span></span>

1. <span data-ttu-id="c0487-215">返回到插件管理页 (**网站管理** > **插件** > **Microsoft Office 365 集成**)，然后选择**工作组设置**选项卡。</span><span class="sxs-lookup"><span data-stu-id="c0487-215">Return to the plugin administration page (**Site administration** > **Plugins** > **Microsoft Office 365 Integration**) and select the **Teams Settings** tab.</span></span>
2. <span data-ttu-id="c0487-216">单击**Microsoft 应用程序注册门户**链接和登录您的 Microsoft id。</span><span class="sxs-lookup"><span data-stu-id="c0487-216">Click the **Microsoft Application Registration Portal** link and sign in with your Microsoft ID.</span></span>
3. <span data-ttu-id="c0487-217">输入应用程序 (例如，MoodleBot) 的名称，然后单击**创建**按钮。</span><span class="sxs-lookup"><span data-stu-id="c0487-217">Enter a name for you app (for example, MoodleBot) and click the **Create** button.</span></span>
4. <span data-ttu-id="c0487-218">复制的**应用程序 ID** ，并将其粘贴到**工作组设置**页上的**自动程序应用程序 ID**字段。</span><span class="sxs-lookup"><span data-stu-id="c0487-218">Copy the **Application ID** and paste it into the **Bot Application ID** field on the **Team Settings** page.</span></span>
5. <span data-ttu-id="c0487-219">单击**生成新密码**按钮。</span><span class="sxs-lookup"><span data-stu-id="c0487-219">Click the **Generate New Password** button.</span></span> <span data-ttu-id="c0487-220">复制生成的密码并将其粘贴到**工作组设置**页上的**自动程序应用程序密码**字段。</span><span class="sxs-lookup"><span data-stu-id="c0487-220">Copy the generated password and paste it into the **Bot Application Password** field on the **Team Settings** page.</span></span>
6. <span data-ttu-id="c0487-221">滚动到窗体的底部，单击**保存更改**。</span><span class="sxs-lookup"><span data-stu-id="c0487-221">Scroll to the bottom of the form and click **Save Changes**.</span></span>

<span data-ttu-id="c0487-222">既然已生成您的应用程序 ID 和密码，就可以部署到 Azure 您自动程序。</span><span class="sxs-lookup"><span data-stu-id="c0487-222">Now that you've generated your application ID and password, it's time to deploy your bot to Azure.</span></span> <span data-ttu-id="c0487-223">单击**部署到 Azure**按钮，并填写表单的必要信息 （自动程序 ID 和密码是否在**工作组设置**页上和**设置**页上的 Azure 信息是）。</span><span class="sxs-lookup"><span data-stu-id="c0487-223">Click the **Deploy to Azure** button and complete the form with the necessary information (the bot ID and password are on the **Team Settings** page, and the Azure information is on the **Setup** page).</span></span> <span data-ttu-id="c0487-224">填写表单后，单击接受条款和条件，然后单击**购买**按钮 （所有 Azure 资源部署到的免费层） 复选框。</span><span class="sxs-lookup"><span data-stu-id="c0487-224">Once you have the form filled out, click the check box to agree to the terms and conditions, and then click the **Purchase** button (all Azure resources are deployed to the free tier).</span></span>

<span data-ttu-id="c0487-225">资源已完成后部署到 Azure，您将需要使用其消息的终结点配置 Office 365 Moodle 插件。</span><span class="sxs-lookup"><span data-stu-id="c0487-225">After the resources are finished deploying to Azure, you'll need to configure the Office 365 Moodle plugin with its messaging endpoint.</span></span> <span data-ttu-id="c0487-226">首先，您需要从您 bot Azure 中获取终结点。</span><span class="sxs-lookup"><span data-stu-id="c0487-226">First, you'll need to get the endpoint from your bot in Azure.</span></span> <span data-ttu-id="c0487-227">若要此操作：</span><span class="sxs-lookup"><span data-stu-id="c0487-227">To do this:</span></span>

1. <span data-ttu-id="c0487-228">如果不已签名，登录到[Azure 门户](https://portal.azure.com)。</span><span class="sxs-lookup"><span data-stu-id="c0487-228">If you aren't signed in already, sign in to the [Azure portal](https://portal.azure.com).</span></span>
2. <span data-ttu-id="c0487-229">在左窗格中，选择**资源组**。</span><span class="sxs-lookup"><span data-stu-id="c0487-229">In the left pane, select **Resource groups**.</span></span>
3. <span data-ttu-id="c0487-230">从列表中，选择部署您自动程序时的您只需使用 （或创建） 的资源组。</span><span class="sxs-lookup"><span data-stu-id="c0487-230">From the list, select the resource group you just used (or created) while deploying your bot.</span></span>
4. <span data-ttu-id="c0487-231">从组中的资源的列表中选择**WebApp Bot**资源。</span><span class="sxs-lookup"><span data-stu-id="c0487-231">Select the **WebApp Bot** resource from the list of resources in the group.</span></span>
5. <span data-ttu-id="c0487-232">从**概述**部分中复制**消息终结点**。</span><span class="sxs-lookup"><span data-stu-id="c0487-232">Copy the **Messaging Endpoint** from the **Overview** section.</span></span>
6. <span data-ttu-id="c0487-233">在 Moodle，打开您的 Office 365 Moodle 插件**工作组设置**页。</span><span class="sxs-lookup"><span data-stu-id="c0487-233">In Moodle, open the **Team Settings** page of your Office 365 Moodle plugin.</span></span>
7. <span data-ttu-id="c0487-234">在**自动程序终结点**字段中，粘贴您刚复制的 URL 和更改为*webhook*的单词*的邮件*。</span><span class="sxs-lookup"><span data-stu-id="c0487-234">In the **Bot Endpoint** field, paste the URL you just copied, and change the word *messages* to *webhook*.</span></span> <span data-ttu-id="c0487-235">URL 现在应如下所示： `https://botname.azurewebsites.net/api/webhook`。</span><span class="sxs-lookup"><span data-stu-id="c0487-235">The URL should now look like this: `https://botname.azurewebsites.net/api/webhook`.</span></span>
8. <span data-ttu-id="c0487-236">单击**保存更改**。</span><span class="sxs-lookup"><span data-stu-id="c0487-236">Click **Save Changes**.</span></span>
9. <span data-ttu-id="c0487-237">后所做的更改将保存，返回到**工作组设置**选项卡，单击**下载清单文件**按钮和 （将在下一步中使用它） 在计算机上保存清单程序包。</span><span class="sxs-lookup"><span data-stu-id="c0487-237">Once your changes are saved, go back to the **Team Settings** tab, click the **Download manifest file** button, and save the manifest package on your computer (you'll use it in the next step).</span></span>

## <a name="step-4-deploy-your-microsoft-teams-app"></a><span data-ttu-id="c0487-238">步骤 4： 部署 Microsoft 团队的应用程序</span><span class="sxs-lookup"><span data-stu-id="c0487-238">Step 4: Deploy your Microsoft Teams app</span></span>

> [!VIDEO https://www.youtube.com/embed/2rMb7gtM_ZM]

<span data-ttu-id="c0487-239">现在，您具有部署 Azure 中的您自动程序，并将其与 Moodle 服务器配置为，就可以部署 Microsoft 团队的应用程序。</span><span class="sxs-lookup"><span data-stu-id="c0487-239">Now that you have deployed your bot in Azure and configured it to talk to your Moodle server, it's time to deploy your Microsoft Teams app.</span></span> <span data-ttu-id="c0487-240">若要执行此操作将加载在上一步 Office 365 Moodle 插件**工作组设置**页从您下载的清单文件。</span><span class="sxs-lookup"><span data-stu-id="c0487-240">To do this you'll load the manifest file you downloaded from the Office 365 Moodle plugin **Team Settings** page in the previous step.</span></span>

<span data-ttu-id="c0487-241">您可以安装应用程序之前，您需要确保已启用外部应用程序和应用程序的 sideloading。</span><span class="sxs-lookup"><span data-stu-id="c0487-241">Before you can install the app, you'll need to make sure that external apps and sideloading of apps is enabled.</span></span> <span data-ttu-id="c0487-242">若要执行此操作，请按照[下列步骤](https://docs.microsoft.com/en-us/MicrosoftTeams/admin-settings)。</span><span class="sxs-lookup"><span data-stu-id="c0487-242">To do this, follow [these steps](https://docs.microsoft.com/en-us/MicrosoftTeams/admin-settings).</span></span> <span data-ttu-id="c0487-243">一次已确保已启用外部应用程序，请按照以下步骤来部署您的应用程序。</span><span class="sxs-lookup"><span data-stu-id="c0487-243">Once you've ensured that external apps are enabled, follow the steps below to deploy your app.</span></span>

1. <span data-ttu-id="c0487-244">打开 Microsoft 团队。</span><span class="sxs-lookup"><span data-stu-id="c0487-244">Open Microsoft Teams.</span></span>
2. <span data-ttu-id="c0487-245">单击左下方的导航栏上的**Store**图标。</span><span class="sxs-lookup"><span data-stu-id="c0487-245">Click the **Store** icon on the lower-left of the navigation bar.</span></span>
3. <span data-ttu-id="c0487-246">单击从选项列表中的**上载自定义应用程序**链接。</span><span class="sxs-lookup"><span data-stu-id="c0487-246">Click the **Upload a custom app** link from the list of options.</span></span> 
   > [!NOTE]
   > <span data-ttu-id="c0487-247">如果您以全局管理员身份登录，您必须将应用程序上载到组织的应用程序商店; 的选项否则您只将能够加载应用程序后团队 (*sideloading*) 的一部分。</span><span class="sxs-lookup"><span data-stu-id="c0487-247">If you're signed in as a global administrator, you'll have the option of uploading the app to your organization's app store; otherwise you'll only be able to load the app for the teams you're a part of (*sideloading*).</span></span>
4. <span data-ttu-id="c0487-248">选择您以前，下载的 manifest.zip 包，然后单击**保存**。</span><span class="sxs-lookup"><span data-stu-id="c0487-248">Select the manifest.zip package you downloaded previously, and click **Save**.</span></span> <span data-ttu-id="c0487-249">如果尚未尚未下载清单包，您可以从 Moodle 插件配置页的**工作组设置**选项卡来完成操作。</span><span class="sxs-lookup"><span data-stu-id="c0487-249">If you haven't yet downloaded the manifest package, you can do so from the **Team Settings** tab of the plugin configuration page in Moodle.</span></span>

<span data-ttu-id="c0487-250">既然您已经安装该应用程序，您可以将选项卡添加到有权访问任何通道。</span><span class="sxs-lookup"><span data-stu-id="c0487-250">Now that you have the app installed, you can add the tab to any channel that you have access to.</span></span> <span data-ttu-id="c0487-251">若要执行此操作，导航到该频道，单击**+** 符号，并从列表中选择您的应用程序。</span><span class="sxs-lookup"><span data-stu-id="c0487-251">To do this, navigate to the channel, click the **+** symbol, and select your app from the list.</span></span> <span data-ttu-id="c0487-252">按照提示完成向通道添加您 Moodle 课程的选项卡。</span><span class="sxs-lookup"><span data-stu-id="c0487-252">Follow the prompts to finish adding your Moodle course tab to a channel.</span></span>

<span data-ttu-id="c0487-253">就是这样！</span><span class="sxs-lookup"><span data-stu-id="c0487-253">That's it!</span></span> <span data-ttu-id="c0487-254">您和您的团队，现在即可开始使用您直接从 Microsoft 团队的 Moodle 课程。</span><span class="sxs-lookup"><span data-stu-id="c0487-254">You and your team, can now start working with your Moodle courses directly from Microsoft Teams.</span></span>

<span data-ttu-id="c0487-255">要与我们共享任何功能请求或提供反馈，请访问我们的[用户语音页](https://microsoftteams.uservoice.com/forums/916759-moodle)。</span><span class="sxs-lookup"><span data-stu-id="c0487-255">To share any feature requests with us or provide feedback, please visit our [User Voice page](https://microsoftteams.uservoice.com/forums/916759-moodle).</span></span>