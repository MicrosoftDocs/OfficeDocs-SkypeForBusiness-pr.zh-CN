---
title: Lync Server 2013：为内部边缘接口设置证书
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Set up certificates for the internal edge interface
ms:assetid: a1963cc9-87c5-4935-86c0-6bedc6afd0ac
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Gg412750(v=OCS.15)
ms:contentKeyID: 48184949
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: ea6e462bdc629308493799c857ecb6b2434dc268
ms.sourcegitcommit: b693d5923d6240cbb865241a5750963423a4b33e
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/04/2020
ms.locfileid: "41732262"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/en-us/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="set-up-certificates-for-the-internal-edge-interface-in-lync-server-2013"></a>在 Lync Server 2013 中为内部边缘接口设置证书

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**主题上次修改时间：** 2013-11-07_

<div>


> [!IMPORTANT]  
> 当你运行证书向导时，请确保你使用的帐户是已为你将使用的证书模板类型分配了相应权限的组的成员。 默认情况下，Lync Server 2013 证书请求将使用 Web 服务器证书模板。 如果您使用的帐户是 RTCUniversalServerAdmins 组的成员以使用此模板申请证书，请验证该组是否已分配使用该模板所需的注册权限。



</div>

每个 Edge 服务器的内部接口上都需要一个证书。 内部接口的证书可以由内部企业证书颁发机构（CA）或公共 CA 颁发。 如果您的组织已部署内部 CA，您可以通过使用内部 CA 颁发内部接口的证书来节省使用公共证书的费用。 你可以使用内部 Windows Server 2008 CA 或 Windows Server 2008 R2 CA 创建这些证书。

有关此和其他证书要求的详细信息，请参阅[Lync Server 2013 中的外部用户访问证书要求](lync-server-2013-certificate-requirements-for-external-user-access.md)。

若要在网站上的内部边缘界面上设置证书，请使用本部分中的步骤执行以下操作：

1.  将内部接口的 CA 证书链下载到每个边缘服务器。

2.  在每台边缘服务器上导入内部接口的 CA 证书链。

3.  在一台边缘服务器上为内部接口创建证书请求，称为第一台边缘服务器。

4.  导入第一边缘服务器上的内部接口的证书。

5.  导入此站点（或部署在此负载平衡器下方）的其他边缘服务器上的证书。

6.  为每个边缘服务器的内部接口分配证书。

如果你有多个具有 Edge 服务器（即多站点边缘拓扑）的网站，或者在不同负载平衡器之后部署的一组单独的边缘服务器，则需要针对每个具有 Edge 服务器的网站以及每组边缘服务器执行以下步骤部署在不同负载平衡器之后。

<div>


> [!NOTE]  
> 本部分中的步骤的步骤基于使用 Windows Server&nbsp;2008 Ca、windows server&nbsp;2008&nbsp;R2 ca、Windows server 2012 CA 或 windows server 2012 R2 ca 为每个边缘服务器创建证书。 有关任何其他 CA 的分步指南，请参阅该 CA 的文档。 默认情况下，所有经过身份验证的用户都拥有申请证书的相应用户权限。<BR>本部分中的过程基于在边缘服务器上创建证书请求（作为边缘服务器部署过程的一部分）。 可以使用前端服务器创建证书请求。 在开始部署边缘服务器之前，你可以执行此操作以在计划和部署过程的早期完成证书请求。 若要执行此操作，必须确保你请求的证书使用可导出的私钥进行定义。<BR>本节中的过程介绍了如何对证书使用 .cer 和. p7b 文件。 如果你使用其他类型的文件，请根据需要修改这些过程。



</div>

<div>

## <a name="to-download-the-ca-certification-chain-for-the-internal-interface-using-certsrv-web-site"></a>使用 certsrv 网站下载内部接口的 CA 证书链

1.  以**管理员**组成员的身份登录到内部网络（即，不是边缘服务器）中的 Lync server 2013 服务器。

2.  在命令提示符处运行以下命令，方法是单击 "**开始**"，单击 "**运行**"，然后键入以下命令：
    
        https://<name of your Issuing CA Server>/certsrv
    
    例如：
    
        https://ca01.contoso.net/certsrv
    
    <div>
    

    > [!NOTE]  
    > 如果您使用的是 Windows Server 2008 或 Windows Server 2008 R2 enterprise CA，则必须使用 https，而不是 http。

    
    </div>

3.  在发证 CA 的 certsrv 网页上，在“**选择任务**”下，单击“**下载 CA 证书、证书链或 CRL**”。

4.  在 "**下载 Ca 证书、证书链或 CRL**" 下，单击 "**下载 ca 证书链**"。

5.  在 "**文件下载**" 对话框中，单击 "**保存**"。

6.  将. p7b 文件保存到服务器上的硬盘驱动器，然后将其复制到每台边缘服务器上的某个文件夹中。
    
    <div>
    

    > [!NOTE]  
    > P7b 文件包含证书路径中的所有证书。 若要查看证书路径，请打开服务器证书，然后单击证书路径。

    
    </div>

</div>

<div>

## <a name="to-export-the-ca-certification-chain-for-the-internal-interface-using-mmc"></a>使用 MMC 导出内部接口的 CA 证书链

1.  你可以使用 Microsoft 管理控制台（MMC）从任何加入域的计算机导出 CA 根证书。 单击 "**开始**"，单击 "**运行**"，然后键入 " **MMC**"。

2.  在 MMC 控制台中，单击 "**文件**"，然后单击 "**添加/删除**"。

3.  从 "**添加或删除管理单元**" 对话框列表中，选择 "**证书**"，然后单击 "**添加**"。 出现提示时，选择 "**计算机帐户**"。 在“**选择计算机**”对话框中，选择“**本地计算机**”。 单击“**完成**”。 单击“**确定**”。

4.  展开 "**证书（本地计算机）**"。 展开 "**受信任的根证书颁发机构**"，选择 "**证书**"。

5.  单击由 CA 颁发的根证书。 右键单击证书，选择 "**所有任务**"，然后选择 "**导出**"。 将打开 "**证书导出向导**"。

6.  在“**证书导出向导**”中，单击“**下一步**”。

7.  在 "**导出文件格式**" 对话框中，选择要导出到的格式。 我们建议采用**加密消息语法标准-PKCS \#7 证书（。P7B）**。 如果你选择**加密消息语法标准-PKCS \#7 证书（。P7B）**，选择 "**如果可能，则包括证书路径中的所有证书**" 复选框以导出证书链，包括根 ca 证书和任何中间 ca 证书。 单击" **下一步**"。

8.  在 "文件名" 条目中的 "**要导出的文件**" 对话框中，为导出的证书键入路径和文件名（默认扩展名为. p7b）。 （可选）单击 "**浏览**"，找到要将导出的证书放入其中并为导出的证书提供名称的目录。 单击“**保存**”。 单击" **下一步**"。

9.  查看操作摘要，然后单击 "**完成**" 以完成证书导出。 单击“**确定**”确认导出成功。

</div>

<div>

## <a name="to-import-the-ca-certification-chain-for-the-internal-interface"></a>导入内部接口的 CA 证书链

1.  在每台边缘服务器上，依次单击 "**开始**" 和 "**运行**"，在 "**打开**" 框中键入**MMC** ，然后单击 **"确定"**，打开 Microsoft 管理控制台（MMC）。

2.  在 "**文件**" 菜单上，单击 "**添加/删除管理单元**"，然后单击 "**添加**"。

3.  在 "**添加独立的管理单元**" 框中，单击 "**证书**"，然后单击 "**添加**"。

4.  在“**证书管理单元**”对话框中，单击“**计算机帐户**”，然后单击“**下一步**”。

5.  在 "**选择计算机**" 对话框中，确保选中 "**本地计算机：（运行此控制台的计算机）** " 复选框，然后单击 "**完成**"。

6.  单击 "**关闭**"，然后单击 **"确定"**。

7.  在控制台树中，展开 "**证书（本地计算机）**"，右键单击 "**受信任的根证书颁发机构**"，指向 "**所有任务**"，然后单击 "**导入**"。

8.  在向导中，在 "**要导入的文件**" 中，指定证书的文件名（即，您在上一过程中下载内部接口的 CA 证书链时指定的名称）。

9.  在每个边缘服务器上重复此过程。

</div>

<div>

## <a name="to-create-the-certificate-request-for-the-internal-interface"></a>为内部接口创建证书请求

1.  在其中一个边缘服务器上，启动部署向导，然后在**步骤3： "请求"、"安装" 或 "分配证书**" 旁边，单击 "**运行**"。
    
    <div>
    

    > [!NOTE]  
    > 如果池中的一个位置有多个边缘服务器，则可以在任何一个边缘服务器上运行证书向导。<BR>第一次运行第3步后，按钮将更改为 "<STRONG>再次运行</STRONG>"，并且将不显示指示成功完成任务的绿色复选标记，直到所有需要的证书都已请求、安装和分配。

    
    </div>

2.  在“**可用的证书任务**”页上，单击“**创建新的证书请求**”。

3.  在 "**证书请求**" 页面上，单击 "**下一步**"。

4.  在“**延迟的请求或即时请求**”页上，单击“**现在准备请求，但稍后发送**”。

5.  在 "**证书请求文件**" 页面上，键入要保存请求的完整路径和文件名（例如， **c：\\cert\_内部\_edge .cer**）。

6.  在 "**指定备用证书模板**" 页面上，若要使用默认 web 台模板之外的模板，请选中 "**为所选证书颁发机构使用备用证书模板**" 复选框。

7.  在 "**名称和安全设置**" 页面上，执行下列操作：
    
      - 在 "**友好名称**" 中，键入证书的 "显示名称" （例如，"内部边缘"）。
    
      - 在 "**位长度**" 中，指定位长度（通常为默认值**2048**）。
        
        <div>
        

        > [!NOTE]  
        > 较高的位长度提供更高的安全性，但它们对速度有负面影响。

        
        </div>
    
      - 如果证书需要可导出，请选中 "将**证书私钥标记为可导出**" 复选框。

8.  在 "**组织信息**" 页面上，键入组织和组织单位（OU）的名称（例如，"部门" 或 "部门"）。

9.  在 "**地理信息**" 页面上，指定位置信息。

10. 在 "**主题名称/主题备用名称**" 页面上，将显示要由向导自动填充的信息。

11. 在 "**配置其他主题备用名称**" 页面上，指定所需的任何其他主题备用名称。

12. 在 "**请求摘要**" 页面上，查看将要用于生成请求的证书信息。

13. 命令完成后，请执行下列操作：
    
      - 若要查看证书请求的日志，请单击 "**查看日志**"。
    
      - 若要完成证书请求，请单击 "**下一步**"。

14. 在 "**证书请求文件**" 页面上，执行下列操作：
    
      - 若要查看生成的证书签名请求（CSR）文件，请单击 "**查看**"。
    
      - 若要关闭向导，请单击“**完成**”。

15. 将此文件提交给你的 CA （通过电子邮件或你的组织为您的企业 CA 支持的其他方法），并且当您收到响应文件时，将新证书复制到此计算机，以便它可用于导入。

</div>

<div>

## <a name="to-import-the-certificate-for-the-internal-interface"></a>导入内部接口的证书

1.  登录到作为本地管理员组成员创建证书申请的边缘服务器。

2.  在 "部署向导" 的 "**步骤3：请求、安装或分配证书**" 旁边，**再次**单击 "运行"。
    
    第一次运行步骤3后，按钮将更改为**再次运行**，但绿色复选标记（指示任务成功完成）将不会显示，直到所有需要的证书都已请求、安装和分配。

3.  在 "**可用的证书任务**" 页面上，单击 "**从 a 导入证书"。P7b、.pfx 或 .cer 文件**。

4.  在 "**导入证书**" 页面上，键入你为此边缘服务器的内部接口请求和接收的证书的完整路径和文件名（或者，单击 "**浏览**" 以查找并选择该文件）。

5.  如果要为池的其他成员导入证书，其中包含私钥，请选中 "**证书文件包含 certifcate 的私钥**" 复选框并指定密码。

</div>

<div>

## <a name="to-export-the-certificate-with-the-private-key-for-edge-servers-in-a-pool"></a>导出具有池中的边缘服务器的私钥的证书

1.  以管理员组成员的身份登录到您在其中导入证书的同一边缘服务器。

2.  单击 "**开始**"，单击 "**运行**"，然后键入 " **MMC**"。

3.  从 MMC 控制台中，单击 "**文件**"，然后单击 "**添加/删除管理单元**"。

4.  在 "添加或删除管理单元" 页面上，单击 "**证书**"，然后单击 "**添加**"。

5.  在 "证书管理单元" 对话框中，选择 "**计算机帐户**"。 单击" **下一步**"。 在 "选择计算机" 中，选择 "**本地计算机：" （运行此控制台的计算机）**。 单击“**完成**”。 单击 **"确定"** 以完成 MMC 控制台的配置。

6.  双击“**证书(本地计算机)**”展开证书存储。 双击 "**个人**"，然后双击 "**证书**"。
    
    <div>
    

    > [!IMPORTANT]  
    > 如果本地计算机的 "证书个人" 存储中没有证书，则没有与导入的证书相关联的私钥。 查看请求和导入步骤。 如果问题仍然存在，请联系您的证书颁发机构管理员或提供商。

    
    </div>

7.  在本地计算机的 "证书个人" 存储中，右键单击要导出的证书。 单击 "**所有任务**"，然后单击 "**导出**"。

8.  在 "证书导出向导" 中，单击 "**下一步**"。 选择“**是，导出私钥**”。 单击“**下一步**”。
    
    <div>
    

    > [!NOTE]  
    > 如果选择<STRONG>"是"，则导出私钥</STRONG>不可用，与此证书关联的私钥未标记为 "导出"。 您需要再次申请证书，确保证书已标记为允许导出私钥，然后您才能继续导出操作。 联系您的证书颁发机构管理员或提供商。

    
    </div>

9.  在 "导出文件格式" 对话框中，选择 "**个人信息\#交换-PKCS 12 （。PFX）** ，然后选择以下操作：
    
      - 如果可能，包括证书路径中的所有证书
    
      - 导出所有扩展属性
        
        <div>
        

        > [!WARNING]  
        > 从边缘服务器导出证书时，如果导出成功，请勿选择 "<STRONG>删除私钥"</STRONG>。 选择此选项将要求你将证书和私钥导入此 Edge 服务器。

        
        </div>
    
    单击“**下一步**”继续。

10. 如果要分配密码以保护私钥，请键入私钥的密码。 重新输入密码进行确认。 单击" **下一步**"。

11. 为导出的证书键入路径和文件名，并使用文件扩展名 .pfx。 该路径必须可由池中的所有其他边缘服务器访问，或可通过可移动媒体（例如，USB 闪存驱动器）进行传输。 单击" **下一步**"。

12. 查看 "完成证书导出向导" 对话框中的摘要。 单击“**完成**”。

13. 在成功导出对话框中单击“**确定**”。

14. 按照[为 Lync Server 2013 过程设置外部边缘界面的证书](lync-server-2013-set-up-certificates-for-the-external-edge-interface.md)中所述的步骤，将导出的证书文件导入其他边缘服务器。

</div>

<div>

## <a name="to-assign-the-internal-certificate-on-the-edge-servers"></a>在边缘服务器上分配内部证书

1.  在每个边缘服务器上的 "部署向导" 中，在 "**步骤3：请求、安装或分配证书**" 旁边，再次单击 "**运行**"。

2.  在 "**可用的证书任务**" 页面上，单击 "**分配现有证书**"。

3.  在“**证书分配**”页上，选择列表中的“**边缘内部**”。

4.  在 "**证书存储**" 页面上，选择为内部边缘导入的证书（从上一个过程中）。

5.  在 "**证书分配摘要**" 页面上，查看您的设置，然后单击 "**下一步**" 以分配证书。

6.  在向导完成页上，单击“**完成**”。

7.  使用此过程分配内部边缘证书后，在每台服务器上打开 "证书" 管理单元，展开 "**证书（本地计算机）**" **，展开 "证书"，单击**"**证书**"，然后验证 "详细信息" 窗格中是否列出了内部边缘证书。

8.  如果你的部署包含多个边缘服务器，请为每个边缘服务器重复此过程。

</div>

</div>

<span> </span>

</div>

</div>

</div>

